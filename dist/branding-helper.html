<!doctype html>
<html lang="en">
    <head>
        <style>
            body {
                font-family:
                    system-ui,
                    -apple-system,
                    BlinkMacSystemFont,
                    'Segoe UI',
                    Roboto,
                    Oxygen,
                    Ubuntu,
                    Cantarell,
                    'Open Sans',
                    'Helvetica Neue',
                    sans-serif;
            }
            label {
                display: grid;
                grid-template-columns: 12em 1fr;
            }
            fieldset {
                display: grid;
                gap: 1ex;
            }
            legend {
                font-weight: bolder;
            }
            label strong {
                font-weight: 500;
            }
            label input[type="checkbox"] {
                justify-self: start;
            }

            .grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                justify-items: start;
                border: none;
                padding: 1ex 0;
            }
            #download_link {
                background: #efefef;
                background: buttonface;
                color: buttontext;
                text-decoration: none;
                cursor: pointer;
                box-sizing: border-box;
                padding: 4px 6px;
                border: 1px outset buttonborder;
                border-radius: 2px;
            }
            #download_link:not([href]) {
                display: none;
            }
            #config_form.is-rtmp #sip_settings {
                display: none;
            }
            #config_form:not(.is-rtmp) #rtmp_settings {
                display: none;
            }
        </style>
      <script type="module" crossorigin>(function(){const Z=document.createElement("link").relList;if(Z&&Z.supports&&Z.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))n(d);new MutationObserver(d=>{for(const b of d)if(b.type==="childList")for(const W of b.addedNodes)W.tagName==="LINK"&&W.rel==="modulepreload"&&n(W)}).observe(document,{childList:!0,subtree:!0});function c(d){const b={};return d.integrity&&(b.integrity=d.integrity),d.referrerPolicy&&(b.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?b.credentials="include":d.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function n(d){if(d.ep)return;d.ep=!0;const b=c(d);fetch(d.href,b)}})();var v=Uint8Array,z=Uint16Array,Sl=Int32Array,el=new v([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Vl=new v([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sl=new v([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jl=function(l,Z){for(var c=new z(31),n=0;n<31;++n)c[n]=Z+=1<<l[n-1];for(var d=new Sl(c[30]),n=1;n<30;++n)for(var b=c[n];b<c[n+1];++b)d[b]=b-c[n]<<5|n;return{b:c,r:d}},Ql=jl(el,2),Ul=Ql.b,Nl=Ql.r;Ul[28]=258,Nl[258]=28;var zl=jl(Vl,0),ql=zl.b,gl=zl.r,Il=new z(32768);for(var t=0;t<32768;++t){var $=(t&43690)>>1|(t&21845)<<1;$=($&52428)>>2|($&13107)<<2,$=($&61680)>>4|($&3855)<<4,Il[t]=(($&65280)>>8|($&255)<<8)>>1}var E=function(l,Z,c){for(var n=l.length,d=0,b=new z(Z);d<n;++d)l[d]&&++b[l[d]-1];var W=new z(Z);for(d=1;d<Z;++d)W[d]=W[d-1]+b[d-1]<<1;var u;if(c){u=new z(1<<Z);var X=15-Z;for(d=0;d<n;++d)if(l[d])for(var G=d<<4|l[d],i=Z-l[d],m=W[l[d]-1]++<<i,a=m|(1<<i)-1;m<=a;++m)u[Il[m]>>X]=G}else for(u=new z(n),d=0;d<n;++d)l[d]&&(u[d]=Il[W[l[d]-1]++]>>15-l[d]);return u},ll=new v(288);for(var t=0;t<144;++t)ll[t]=8;for(var t=144;t<256;++t)ll[t]=9;for(var t=256;t<280;++t)ll[t]=7;for(var t=280;t<288;++t)ll[t]=8;var ul=new v(32);for(var t=0;t<32;++t)ul[t]=5;var $l=E(ll,9,0),lZ=E(ll,9,1),ZZ=E(ul,5,0),cZ=E(ul,5,1),tl=function(l){for(var Z=l[0],c=1;c<l.length;++c)l[c]>Z&&(Z=l[c]);return Z},P=function(l,Z,c){var n=Z/8|0;return(l[n]|l[n+1]<<8)>>(Z&7)&c},ol=function(l,Z){var c=Z/8|0;return(l[c]|l[c+1]<<8|l[c+2]<<16)>>(Z&7)},Ll=function(l){return(l+7)/8|0},al=function(l,Z,c){return(Z==null||Z<0)&&(Z=0),(c==null||c>l.length)&&(c=l.length),new v(l.subarray(Z,c))},nZ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],f=function(l,Z,c){var n=new Error(Z||nZ[l]);if(n.code=l,Error.captureStackTrace&&Error.captureStackTrace(n,f),!c)throw n;return n},dZ=function(l,Z,c,n){var d=l.length,b=n?n.length:0;if(!d||Z.f&&!Z.l)return c||new v(0);var W=!c,u=W||Z.i!=2,X=Z.i;W&&(c=new v(d*3));var G=function(ml){var Wl=c.length;if(ml>Wl){var dl=new v(Math.max(Wl*2,ml));dl.set(c),c=dl}},i=Z.f||0,m=Z.p||0,a=Z.b||0,h=Z.l,V=Z.d,e=Z.m,r=Z.n,x=d*8;do{if(!h){i=P(l,m,1);var g=P(l,m+1,3);if(m+=3,g)if(g==1)h=lZ,V=cZ,e=9,r=5;else if(g==2){var F=P(l,m,31)+257,I=P(l,m+10,15)+4,p=F+P(l,m+5,31)+1;m+=14;for(var Y=new v(p),S=new v(19),J=0;J<I;++J)S[sl[J]]=P(l,m+J*3,7);m+=I*3;for(var H=tl(S),q=(1<<H)-1,j=E(S,H,1),J=0;J<p;){var k=j[P(l,m,q)];m+=k&15;var s=k>>4;if(s<16)Y[J++]=s;else{var L=0,o=0;for(s==16?(o=3+P(l,m,3),m+=2,L=Y[J-1]):s==17?(o=3+P(l,m,7),m+=3):s==18&&(o=11+P(l,m,127),m+=7);o--;)Y[J++]=L}}var T=Y.subarray(0,F),K=Y.subarray(F);e=tl(T),r=tl(K),h=E(T,e,1),V=E(K,r,1)}else f(1);else{var s=Ll(m)+4,N=l[s-4]|l[s-3]<<8,R=s+N;if(R>d){X&&f(0);break}u&&G(a+N),c.set(l.subarray(s,R),a),Z.b=a+=N,Z.p=m=R*8,Z.f=i;continue}if(m>x){X&&f(0);break}}u&&G(a+131072);for(var bl=(1<<e)-1,B=(1<<r)-1,D=m;;D=m){var L=h[ol(l,m)&bl],Q=L>>4;if(m+=L&15,m>x){X&&f(0);break}if(L||f(2),Q<256)c[a++]=Q;else if(Q==256){D=m,h=null;break}else{var U=Q-254;if(Q>264){var J=Q-257,y=el[J];U=P(l,m,(1<<y)-1)+Ul[J],m+=y}var O=V[ol(l,m)&B],cl=O>>4;O||f(3),m+=O&15;var K=ql[cl];if(cl>3){var y=Vl[cl];K+=ol(l,m)&(1<<y)-1,m+=y}if(m>x){X&&f(0);break}u&&G(a+131072);var nl=a+U;if(a<K){var Yl=b-K,hl=Math.min(K,nl);for(Yl+a<0&&f(3);a<hl;++a)c[a]=n[Yl+a]}for(;a<nl;++a)c[a]=c[a-K]}}Z.l=h,Z.p=D,Z.b=a,Z.f=i,h&&(i=1,Z.m=e,Z.d=V,Z.n=r)}while(!i);return a!=c.length&&W?al(c,0,a):c.subarray(0,a)},A=function(l,Z,c){c<<=Z&7;var n=Z/8|0;l[n]|=c,l[n+1]|=c>>8},il=function(l,Z,c){c<<=Z&7;var n=Z/8|0;l[n]|=c,l[n+1]|=c>>8,l[n+2]|=c>>16},yl=function(l,Z){for(var c=[],n=0;n<l.length;++n)l[n]&&c.push({s:n,f:l[n]});var d=c.length,b=c.slice();if(!d)return{t:Pl,l:0};if(d==1){var W=new v(c[0].s+1);return W[c[0].s]=1,{t:W,l:1}}c.sort(function(R,F){return R.f-F.f}),c.push({s:-1,f:25001});var u=c[0],X=c[1],G=0,i=1,m=2;for(c[0]={s:-1,f:u.f+X.f,l:u,r:X};i!=d-1;)u=c[c[G].f<c[m].f?G++:m++],X=c[G!=i&&c[G].f<c[m].f?G++:m++],c[i++]={s:-1,f:u.f+X.f,l:u,r:X};for(var a=b[0].s,n=1;n<d;++n)b[n].s>a&&(a=b[n].s);var h=new z(a+1),V=Jl(c[i-1],h,0);if(V>Z){var n=0,e=0,r=V-Z,x=1<<r;for(b.sort(function(F,I){return h[I.s]-h[F.s]||F.f-I.f});n<d;++n){var g=b[n].s;if(h[g]>Z)e+=x-(1<<V-h[g]),h[g]=Z;else break}for(e>>=r;e>0;){var s=b[n].s;h[s]<Z?e-=1<<Z-h[s]++-1:++n}for(;n>=0&&e;--n){var N=b[n].s;h[N]==Z&&(--h[N],++e)}V=Z}return{t:new v(h),l:V}},Jl=function(l,Z,c){return l.s==-1?Math.max(Jl(l.l,Z,c+1),Jl(l.r,Z,c+1)):Z[l.s]=c},Hl=function(l){for(var Z=l.length;Z&&!l[--Z];);for(var c=new z(++Z),n=0,d=l[0],b=1,W=function(X){c[n++]=X},u=1;u<=Z;++u)if(l[u]==d&&u!=Z)++b;else{if(!d&&b>2){for(;b>138;b-=138)W(32754);b>2&&(W(b>10?b-11<<5|28690:b-3<<5|12305),b=0)}else if(b>3){for(W(d),--b;b>6;b-=6)W(8304);b>2&&(W(b-3<<5|8208),b=0)}for(;b--;)W(d);b=1,d=l[u]}return{c:c.subarray(0,n),n:Z}},Xl=function(l,Z){for(var c=0,n=0;n<Z.length;++n)c+=l[n]*Z[n];return c},Bl=function(l,Z,c){var n=c.length,d=Ll(Z+2);l[d]=n&255,l[d+1]=n>>8,l[d+2]=l[d]^255,l[d+3]=l[d+1]^255;for(var b=0;b<n;++b)l[d+b+4]=c[b];return(d+4+n)*8},fl=function(l,Z,c,n,d,b,W,u,X,G,i){A(Z,i++,c),++d[256];for(var m=yl(d,15),a=m.t,h=m.l,V=yl(b,15),e=V.t,r=V.l,x=Hl(a),g=x.c,s=x.n,N=Hl(e),R=N.c,F=N.n,I=new z(19),p=0;p<g.length;++p)++I[g[p]&31];for(var p=0;p<R.length;++p)++I[R[p]&31];for(var Y=yl(I,7),S=Y.t,J=Y.l,H=19;H>4&&!S[sl[H-1]];--H);var q=G+5<<3,j=Xl(d,ll)+Xl(b,ul)+W,k=Xl(d,a)+Xl(b,e)+W+14+3*H+Xl(I,S)+2*I[16]+3*I[17]+7*I[18];if(X>=0&&q<=j&&q<=k)return Bl(Z,i,l.subarray(X,X+G));var L,o,T,K;if(A(Z,i,1+(k<j)),i+=2,k<j){L=E(a,h,0),o=a,T=E(e,r,0),K=e;var bl=E(S,J,0);A(Z,i,s-257),A(Z,i+5,F-1),A(Z,i+10,H-4),i+=14;for(var p=0;p<H;++p)A(Z,i+3*p,S[sl[p]]);i+=3*H;for(var B=[g,R],D=0;D<2;++D)for(var Q=B[D],p=0;p<Q.length;++p){var U=Q[p]&31;A(Z,i,bl[U]),i+=S[U],U>15&&(A(Z,i,Q[p]>>5&127),i+=Q[p]>>12)}}else L=$l,o=ll,T=ZZ,K=ul;for(var p=0;p<u;++p){var y=n[p];if(y>255){var U=y>>18&31;il(Z,i,L[U+257]),i+=o[U+257],U>7&&(A(Z,i,y>>23&31),i+=el[U]);var O=y&31;il(Z,i,T[O]),i+=K[O],O>3&&(il(Z,i,y>>5&8191),i+=Vl[O])}else il(Z,i,L[y]),i+=o[y]}return il(Z,i,L[256]),i+o[256]},bZ=new Sl([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Pl=new v(0),mZ=function(l,Z,c,n,d,b){var W=b.z||l.length,u=new v(n+W+5*(1+Math.ceil(W/7e3))+d),X=u.subarray(n,u.length-d),G=b.l,i=(b.r||0)&7;if(Z){i&&(X[0]=b.r>>3);for(var m=bZ[Z-1],a=m>>13,h=m&8191,V=(1<<c)-1,e=b.p||new z(32768),r=b.h||new z(V+1),x=Math.ceil(c/3),g=2*x,s=function(rl){return(l[rl]^l[rl+1]<<x^l[rl+2]<<g)&V},N=new Sl(25e3),R=new z(288),F=new z(32),I=0,p=0,Y=b.i||0,S=0,J=b.w||0,H=0;Y+2<W;++Y){var q=s(Y),j=Y&32767,k=r[q];if(e[j]=k,r[q]=j,J<=Y){var L=W-Y;if((I>7e3||S>24576)&&(L>423||!G)){i=fl(l,X,0,N,R,F,p,S,H,Y-H,i),S=I=p=0,H=Y;for(var o=0;o<286;++o)R[o]=0;for(var o=0;o<30;++o)F[o]=0}var T=2,K=0,bl=h,B=j-k&32767;if(L>2&&q==s(Y-B))for(var D=Math.min(a,L)-1,Q=Math.min(32767,Y),U=Math.min(258,L);B<=Q&&--bl&&j!=k;){if(l[Y+T]==l[Y+T-B]){for(var y=0;y<U&&l[Y+y]==l[Y+y-B];++y);if(y>T){if(T=y,K=B,y>D)break;for(var O=Math.min(B,y-2),cl=0,o=0;o<O;++o){var nl=Y-B+o&32767,Yl=e[nl],hl=nl-Yl&32767;hl>cl&&(cl=hl,k=nl)}}}j=k,k=e[j],B+=j-k&32767}if(K){N[S++]=268435456|Nl[T]<<18|gl[K];var ml=Nl[T]&31,Wl=gl[K]&31;p+=el[ml]+Vl[Wl],++R[257+ml],++F[Wl],J=Y+T,++I}else N[S++]=l[Y],++R[l[Y]]}}for(Y=Math.max(Y,J);Y<W;++Y)N[S++]=l[Y],++R[l[Y]];i=fl(l,X,G,N,R,F,p,S,H,Y-H,i),G||(b.r=i&7|X[i/8|0]<<3,i-=7,b.h=r,b.p=e,b.i=Y,b.w=J)}else{for(var Y=b.w||0;Y<W+G;Y+=65535){var dl=Y+65535;dl>=W&&(X[i/8|0]=G,dl=W),i=Bl(X,i+1,l.subarray(Y,dl))}b.i=W}return al(u,0,n+Ll(i)+d)},WZ=function(){for(var l=new Int32Array(256),Z=0;Z<256;++Z){for(var c=Z,n=9;--n;)c=(c&1&&-306674912)^c>>>1;l[Z]=c}return l}(),iZ=function(){var l=-1;return{p:function(Z){for(var c=l,n=0;n<Z.length;++n)c=WZ[c&255^Z[n]]^c>>>8;l=c},d:function(){return~l}}},XZ=function(l,Z,c,n,d){if(!d&&(d={l:1},Z.dictionary)){var b=Z.dictionary.subarray(-32768),W=new v(b.length+l.length);W.set(b),W.set(l,b.length),l=W,d.w=b.length}return mZ(l,Z.level==null?6:Z.level,Z.mem==null?d.l?Math.ceil(Math.max(8,Math.min(13,Math.log(l.length)))*1.5):20:12+Z.mem,c,n,d)},wl=function(l,Z){var c={};for(var n in l)c[n]=l[n];for(var n in Z)c[n]=Z[n];return c},M=function(l,Z){return l[Z]|l[Z+1]<<8},w=function(l,Z){return(l[Z]|l[Z+1]<<8|l[Z+2]<<16|l[Z+3]<<24)>>>0},vl=function(l,Z){return w(l,Z)+w(l,Z+4)*4294967296},C=function(l,Z,c){for(;c;++Z)l[Z]=c,c>>>=8};function uZ(l,Z){return XZ(l,Z||{},0,0)}function aZ(l,Z){return dZ(l,{i:2},Z&&Z.out,Z&&Z.dictionary)}var Ol=function(l,Z,c,n){for(var d in l){var b=l[d],W=Z+d,u=n;Array.isArray(b)&&(u=wl(n,b[1]),b=b[0]),b instanceof v?c[W]=[b,u]:(c[W+="/"]=[new v(0),u],Ol(b,W,c,n))}},xl=typeof TextEncoder<"u"&&new TextEncoder,Rl=typeof TextDecoder<"u"&&new TextDecoder,GZ=0;try{Rl.decode(Pl,{stream:!0}),GZ=1}catch{}var YZ=function(l){for(var Z="",c=0;;){var n=l[c++],d=(n>127)+(n>223)+(n>239);if(c+d>l.length)return{s:Z,r:al(l,c-1)};d?d==3?(n=((n&15)<<18|(l[c++]&63)<<12|(l[c++]&63)<<6|l[c++]&63)-65536,Z+=String.fromCharCode(55296|n>>10,56320|n&1023)):d&1?Z+=String.fromCharCode((n&31)<<6|l[c++]&63):Z+=String.fromCharCode((n&15)<<12|(l[c++]&63)<<6|l[c++]&63):Z+=String.fromCharCode(n)}};function pl(l,Z){var c;if(xl)return xl.encode(l);for(var n=l.length,d=new v(l.length+(l.length>>1)),b=0,W=function(G){d[b++]=G},c=0;c<n;++c){if(b+5>d.length){var u=new v(b+8+(n-c<<1));u.set(d),d=u}var X=l.charCodeAt(c);X<128||Z?W(X):X<2048?(W(192|X>>6),W(128|X&63)):X>55295&&X<57344?(X=65536+(X&1047552)|l.charCodeAt(++c)&1023,W(240|X>>18),W(128|X>>12&63),W(128|X>>6&63),W(128|X&63)):(W(224|X>>12),W(128|X>>6&63),W(128|X&63))}return al(d,0,b)}function Kl(l,Z){if(Z){for(var c="",n=0;n<l.length;n+=16384)c+=String.fromCharCode.apply(null,l.subarray(n,n+16384));return c}else{if(Rl)return Rl.decode(l);var d=YZ(l),b=d.s,c=d.r;return c.length&&f(8),b}}var hZ=function(l,Z){return Z+30+M(l,Z+26)+M(l,Z+28)},pZ=function(l,Z,c){var n=M(l,Z+28),d=Kl(l.subarray(Z+46,Z+46+n),!(M(l,Z+8)&2048)),b=Z+46+n,W=w(l,Z+20),u=c&&W==4294967295?eZ(l,b):[W,w(l,Z+24),w(l,Z+42)],X=u[0],G=u[1],i=u[2];return[M(l,Z+10),X,G,d,b+M(l,Z+30)+M(l,Z+32),i]},eZ=function(l,Z){for(;M(l,Z)!=1;Z+=4+M(l,Z+2));return[vl(l,Z+12),vl(l,Z+4),vl(l,Z+20)]},Fl=function(l){var Z=0;if(l)for(var c in l){var n=l[c].length;n>65535&&f(9),Z+=n+4}return Z},kl=function(l,Z,c,n,d,b,W,u){var X=n.length,G=c.extra,i=u&&u.length,m=Fl(G);C(l,Z,W!=null?33639248:67324752),Z+=4,W!=null&&(l[Z++]=20,l[Z++]=c.os),l[Z]=20,Z+=2,l[Z++]=c.flag<<1|(b<0&&8),l[Z++]=d&&8,l[Z++]=c.compression&255,l[Z++]=c.compression>>8;var a=new Date(c.mtime==null?Date.now():c.mtime),h=a.getFullYear()-1980;if((h<0||h>119)&&f(10),C(l,Z,h<<25|a.getMonth()+1<<21|a.getDate()<<16|a.getHours()<<11|a.getMinutes()<<5|a.getSeconds()>>1),Z+=4,b!=-1&&(C(l,Z,c.crc),C(l,Z+4,b<0?-b-2:b),C(l,Z+8,c.size)),C(l,Z+12,X),C(l,Z+14,m),Z+=16,W!=null&&(C(l,Z,i),C(l,Z+6,c.attrs),C(l,Z+10,W),Z+=14),l.set(n,Z),Z+=X,m)for(var V in G){var e=G[V],r=e.length;C(l,Z,+V),C(l,Z+2,r),l.set(e,Z+4),Z+=4+r}return i&&(l.set(u,Z),Z+=i),Z},VZ=function(l,Z,c,n,d){C(l,Z,101010256),C(l,Z+8,c),C(l,Z+10,c),C(l,Z+12,n),C(l,Z+16,d)};function rZ(l,Z){Z||(Z={});var c={},n=[];Ol(l,"",c,Z);var d=0,b=0;for(var W in c){var u=c[W],X=u[0],G=u[1],i=G.level==0?0:8,m=pl(W),a=m.length,h=G.comment,V=h&&pl(h),e=V&&V.length,r=Fl(G.extra);a>65535&&f(11);var x=i?uZ(X,G):X,g=x.length,s=iZ();s.p(X),n.push(wl(G,{size:X.length,crc:s.d(),c:x,f:m,m:V,u:a!=W.length||V&&h.length!=e,o:d,compression:i})),d+=30+a+r+g,b+=76+2*(a+r)+(e||0)+g}for(var N=new v(b+22),R=d,F=b-d,I=0;I<n.length;++I){var m=n[I];kl(N,m.o,m,m.f,m.u,m.c.length);var p=30+m.f.length+Fl(m.extra);N.set(m.c,m.o+p),kl(N,d,m,m.f,m.u,m.c.length,m.o,m.m),d+=16+p+(m.m?m.m.length:0)}return VZ(N,d,n.length,F,R),N}function tZ(l,Z){for(var c={},n=l.length-22;w(l,n)!=101010256;--n)(!n||l.length-n>65558)&&f(13);var d=M(l,n+8);if(!d)return{};var b=w(l,n+16),W=b==4294967295||d==65535;if(W){var u=w(l,n-12);W=w(l,u)==101075792,W&&(d=w(l,u+32),b=w(l,u+48))}for(var X=0;X<d;++X){var G=pZ(l,b,W),i=G[0],m=G[1],a=G[2],h=G[3],V=G[4],e=G[5],r=hZ(l,e);b=V,i?i==8?c[h]=aZ(l.subarray(r,r+m),{out:new v(a)}):f(14,"unknown compression type "+i):c[h]=al(l,r,r+m)}return c}const oZ={main:"index.html",assets:{"index.html":"PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQoNCjxzY3JpcHQgdHlwZT0ibW9kdWxlIiBjcm9zc29yaWdpbj4oZnVuY3Rpb24oKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpbmsiKS5yZWxMaXN0O2lmKHQmJnQuc3VwcG9ydHMmJnQuc3VwcG9ydHMoIm1vZHVsZXByZWxvYWQiKSlyZXR1cm47Zm9yKGNvbnN0IG8gb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGlua1tyZWw9Im1vZHVsZXByZWxvYWQiXScpKWEobyk7bmV3IE11dGF0aW9uT2JzZXJ2ZXIobz0+e2Zvcihjb25zdCBpIG9mIG8paWYoaS50eXBlPT09ImNoaWxkTGlzdCIpZm9yKGNvbnN0IGYgb2YgaS5hZGRlZE5vZGVzKWYudGFnTmFtZT09PSJMSU5LIiYmZi5yZWw9PT0ibW9kdWxlcHJlbG9hZCImJmEoZil9KS5vYnNlcnZlKGRvY3VtZW50LHtjaGlsZExpc3Q6ITAsc3VidHJlZTohMH0pO2Z1bmN0aW9uIG4obyl7Y29uc3QgaT17fTtyZXR1cm4gby5pbnRlZ3JpdHkmJihpLmludGVncml0eT1vLmludGVncml0eSksby5yZWZlcnJlclBvbGljeSYmKGkucmVmZXJyZXJQb2xpY3k9by5yZWZlcnJlclBvbGljeSksby5jcm9zc09yaWdpbj09PSJ1c2UtY3JlZGVudGlhbHMiP2kuY3JlZGVudGlhbHM9ImluY2x1ZGUiOm8uY3Jvc3NPcmlnaW49PT0iYW5vbnltb3VzIj9pLmNyZWRlbnRpYWxzPSJvbWl0IjppLmNyZWRlbnRpYWxzPSJzYW1lLW9yaWdpbiIsaX1mdW5jdGlvbiBhKG8pe2lmKG8uZXApcmV0dXJuO28uZXA9ITA7Y29uc3QgaT1uKG8pO2ZldGNoKG8uaHJlZixpKX19KSgpO3ZhciBiZTsoZnVuY3Rpb24oZSl7ZVtlLnRyYWNlPTEwXT0idHJhY2UiLGVbZS5kZWJ1Zz0yMF09ImRlYnVnIixlW2UuaW5mbz0zMF09ImluZm8iLGVbZS53YXJuPTQwXT0id2FybiIsZVtlLmVycm9yPTUwXT0iZXJyb3IiLGVbZS5mYXRhbD02MF09ImZhdGFsIixlW2Uuc2lsZW50PU51bWJlci5NQVhfU0FGRV9JTlRFR0VSXT0ic2lsZW50In0pKGJlfHwoYmU9e30pKTtmdW5jdGlvbiBHZSgpe3JldHVybiBPYmplY3QuZnJlZXplKHtmYXRhbDooZSx0KT0+Y29uc29sZS5lcnJvcih0LGUpLGVycm9yOihlLHQpPT5jb25zb2xlLmVycm9yKHQsZSksd2FybjooZSx0KT0+Y29uc29sZS53YXJuKHQsZSksaW5mbzooZSx0KT0+Y29uc29sZS5pbmZvKHQsZSksZGVidWc6KGUsdCk9PmNvbnNvbGUuZGVidWcodCxlKSx0cmFjZSgpe30sc2lsZW50KCl7fSxyZWRhY3QoKXt9fSl9bGV0IHg9R2UoKTtjb25zdCBxZT17fSxYZT1lPT57bGV0IHQ9bmV3IEFycmF5O3JldHVybnthZGQ6bj0+e2lmKGU9PT0wKXJldHVybltdO3QubGVuZ3RoPGU/dC5zcGxpY2UoZSwwLG4pOnQ9Wy4uLnQuc2xpY2UoMSksbl19LGVudHJpZXM6KCk9PnQuc2xpY2UoMCksZm9yRWFjaDpuPT57dC5mb3JFYWNoKG4pfX19LFFlPSJBbm9ueW1vdXMiLFllPSJBbm9ueW1vdXNTaWduYWwiO2Z1bmN0aW9uIFUoZSl7cmV0dXJuIGUubmFtZXx8UWV9ZnVuY3Rpb24geShlPXt9KXtjb25zdHthbGxvd0VtaXR0aW5nV2l0aG91dE9ic2VydmVyOnQ9ITEsdmFyaWFudDpuPSJnZW5lcmljIixidWZmZXJTaXplOmE9MixuYW1lOm89WWV9PWUsaT1uZXcgU2V0LGY9bmV3IFdlYWtNYXAsaD1uZXcgV2Vha1NldCxnPW4hPT0iZ2VuZXJpYyI/WGUobj09PSJiZWhhdmlvciI/MTphKTp2b2lkIDA7ZnVuY3Rpb24gbChjLHMpe3RyeXtjb25zdCB3PWYuZ2V0KGMpO3gudHJhY2Uoe3NpZ25hbDpvLHN1YmplY3Q6cyxvYnNlcnZlcjpjLGNvbnRleHQ6d30sYEVtaXR0aW5nIGEgc3ViamVjdCB0byBvYnNlcnZlciAke1UoYyl9YCksYy5jYWxsKHcscyksaC5oYXMoYykmJmIoYyl9Y2F0Y2godyl7dGhyb3cgeC5lcnJvcih7c2lnbmFsOm8sZXJyb3I6dyxvYnNlcnZlcjpjLHN1YmplY3Q6c30sYGVtaXQgd2l0aCBlcnJvciBmb3Igb2JzZXJ2ZXIgJHtVKGMpfWApLHcgaW5zdGFuY2VvZiBSYW5nZUVycm9yP25ldyBSYW5nZUVycm9yKGBSYW5nZUVycm9yOiBQb3NzaWJsZSByZWN1cnNpdmUgY2FsbCB3aGVuIGNhbGxpbmcgJHtVKGMpfSBmb3IgJHtvfWApOnd9fWNvbnN0IHU9KGMscyk9PntpZihpLmhhcyhjKSl7Y29uc3Qgdz1gT2JzZXJ2ZXIgJHtVKGMpfSBoYXMgYWxyZWFkeSBiZWVuIGFkZGVkIWA7dGhyb3cgeC5lcnJvcih7c2lnbmFsOm8sb2JzZXJ2ZXI6Y30sdyksbmV3IEVycm9yKGBEdXBsaWNhdGVkT2JzZXJ2ZXI6ICR7d31gKX1yZXR1cm4geC50cmFjZSh7c2lnbmFsOm8sb2JzZXJ2ZXI6Y30sYEFkZGluZyAke1UoYyl9IHRvICR7b31gKSxpLmFkZChjKSxzJiZmLnNldChjLHMpLGc/LmZvckVhY2godz0+e2woYyx3KX0pLCgpPT5iKGMpfSxwPShjLHMpPT57aWYoaC5oYXMoYykpe2NvbnN0IHc9YCR7VShjKX0gaGFzIGFscmVhZHkgYmVlbiBhZGRlZCBvbmNlIHRvICR7b30hYDt0aHJvdyB4LmVycm9yKHtzaWduYWw6byxvYnNlcnZlcjpjfSx3KSxuZXcgRXJyb3IoYE5vT25jZUFnYWluOiAke3d9YCl9cmV0dXJuIGguYWRkKGMpLHUoYyxzKX0sYj1jPT57aWYoIWkuZGVsZXRlKGMpKXRocm93IHguZXJyb3Ioe3NpZ25hbDpvLG9ic2VydmVyOmN9LGBVbmFibGUgdG8gcmVtb3ZlIG9ic2VydmVyICR7VShjKX1gKSxuZXcgRXJyb3IoYFVuYWJsZVRvUmVtb3ZlOiAke1UoYyl9YCk7aC5kZWxldGUoYyksZi5kZWxldGUoYykseC50cmFjZSh7c2lnbmFsOm8sb2JzZXJ2ZXI6Y30sYFJlbW92ZWQgJHtVKGMpfSBmcm9tICR7b31gKX0sUD0oKT0+aS5zaXplO2Z1bmN0aW9uIG0oYyl7aWYoZylnLmFkZChjKTtlbHNlIGlmKCFpLnNpemUmJiF0KXtjb25zdHtzdGFjazpzfT1xZS5kZWJ1Zz9uZXcgRXJyb3I6e3N0YWNrOnZvaWQgMH07eC53YXJuKHtzaWduYWw6byxzdWJqZWN0OmMsc3RhY2s6c30sYEVtaXR0aW5nICR7b30gd2l0aG91dCBhbnkgb2JzZXJ2ZXIhIFRoaXMgbWF5IGJlIGEgbWlzdGFrZS5gKX1pLmZvckVhY2gocz0+e2wocyxjKX0pfXJldHVybntuYW1lOm8sZ2V0IHNpemUoKXtyZXR1cm4gUCgpfSxhZGQ6dSxhZGRPbmNlOnAscmVtb3ZlOmIsZW1pdDptfX12YXIgUmU7KGZ1bmN0aW9uKGUpe2VbZS50cmFjZT0xMF09InRyYWNlIixlW2UuZGVidWc9MjBdPSJkZWJ1ZyIsZVtlLmluZm89MzBdPSJpbmZvIixlW2Uud2Fybj00MF09Indhcm4iLGVbZS5lcnJvcj01MF09ImVycm9yIixlW2UuZmF0YWw9NjBdPSJmYXRhbCIsZVtlLnNpbGVudD1OdW1iZXIuTUFYX1NBRkVfSU5URUdFUl09InNpbGVudCJ9KShSZXx8KFJlPXt9KSk7ZnVuY3Rpb24gWmUoKXtyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7ZmF0YWw6KGUsdCk9PmNvbnNvbGUuZXJyb3IodCxlKSxlcnJvcjooZSx0KT0+Y29uc29sZS5lcnJvcih0LGUpLHdhcm46KGUsdCk9PmNvbnNvbGUud2Fybih0LGUpLGluZm86KGUsdCk9PmNvbnNvbGUuaW5mbyh0LGUpLGRlYnVnOihlLHQpPT5jb25zb2xlLmRlYnVnKHQsZSksdHJhY2UoKXt9LHNpbGVudCgpe30scmVkYWN0KCl7fX0pfWxldCBqPVplKCk7ZnVuY3Rpb24gS2UoZSl7cmV0dXJuISEoZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYiY2hhbklkImluIGUmJiJldmVudCJpbiBlKX1mdW5jdGlvbiBldChlKXtyZXR1cm4hIShlJiZ0eXBlb2YgZT09Im9iamVjdCImJiJjaGFuSWQiaW4gZSYmInJlcGx5VG8iaW4gZSl9bGV0IHE7Y29uc3QgdHQ9bmV3IFVpbnQ4QXJyYXkoMTYpO2Z1bmN0aW9uIG50KCl7aWYoIXEmJihxPXR5cGVvZiBjcnlwdG88InUiJiZjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzJiZjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKSwhcSkpdGhyb3cgbmV3IEVycm9yKCJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZCIpO3JldHVybiBxKHR0KX1jb25zdCBDPVtdO2ZvcihsZXQgZT0wO2U8MjU2OysrZSlDLnB1c2goKGUrMjU2KS50b1N0cmluZygxNikuc2xpY2UoMSkpO2Z1bmN0aW9uIHJ0KGUsdD0wKXtyZXR1cm4gQ1tlW3QrMF1dK0NbZVt0KzFdXStDW2VbdCsyXV0rQ1tlW3QrM11dKyItIitDW2VbdCs0XV0rQ1tlW3QrNV1dKyItIitDW2VbdCs2XV0rQ1tlW3QrN11dKyItIitDW2VbdCs4XV0rQ1tlW3QrOV1dKyItIitDW2VbdCsxMF1dK0NbZVt0KzExXV0rQ1tlW3QrMTJdXStDW2VbdCsxM11dK0NbZVt0KzE0XV0rQ1tlW3QrMTVdXX1jb25zdCBvdD10eXBlb2YgY3J5cHRvPCJ1IiYmY3J5cHRvLnJhbmRvbVVVSUQmJmNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKSxQZT17cmFuZG9tVVVJRDpvdH07ZnVuY3Rpb24gYXQoZSx0LG4pe2lmKFBlLnJhbmRvbVVVSUQmJiFlKXJldHVybiBQZS5yYW5kb21VVUlEKCk7ZT1lfHx7fTtjb25zdCBhPWUucmFuZG9tfHwoZS5ybmd8fG50KSgpO3JldHVybiBhWzZdPWFbNl0mMTV8NjQsYVs4XT1hWzhdJjYzfDEyOCxydChhKX1jb25zdCBpdD0iNDAwcHgiLHN0PSIyMDBweCI7ZnVuY3Rpb24gX2UoZSl7cmV0dXJuYCR7ZT9gJHtlfS1gOiIifSR7YXQoKX1gfWZ1bmN0aW9uIGN0KCl7Y29uc3QgZT1uZXcgTWFwLHQ9bmV3IFNldDtyZXR1cm4gd2luZG93Lm9uYmVmb3JldW5sb2FkPSgpPT57dC5mb3JFYWNoKGY9PmNsZWFySW50ZXJ2YWwoZikpLHQuY2xlYXIoKX0se2FkZDooZixoKT0+e2lmKGUuaGFzKGYpKXtqLndhcm4oYEEgcG9wdXAgd2l0aCB3aXRoIElEOicke2Z9JyBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWRgKTtyZXR1cm59ZS5zZXQoZix7cG9wdXA6bnVsbCxzaG91bGRPcGVuOmh9KX0scmVtb3ZlOmY9PntlLmRlbGV0ZShmKX0sb3BlbjooZixoLGcpPT57ZS5oYXMoZil8fGUuc2V0KGYse3BvcHVwOm51bGx9KTtjb25zdCBsPWUuZ2V0KGYpO2lmKGw/LnBvcHVwJiYhbC5wb3B1cC5jbG9zZWQpe2oud2FybihgUG9wdXAgd2l0aCBJRDonJHtmfScgaXMgY3VycmVudGx5IG9wZW5lZGApO3JldHVybn1pZihlLmdldChmKT8uc2hvdWxkT3BlbiYmIWUuZ2V0KGYpPy5zaG91bGRPcGVuPy4oZz8/e30pKXJldHVybjtjb25zdCB1PXdpbmRvdy5vcGVuKC4uLmgpO2lmKGwmJihsLnBvcHVwPXUpLHUpe2NvbnN0IHA9d2luZG93LnNldEludGVydmFsKCgpPT57aWYodS5jbG9zZWQpe2NvbnN0IGI9ZS5nZXQoZik7YiYmKGIucG9wdXA9bnVsbCksY2xlYXJJbnRlcnZhbChwKSx0LmRlbGV0ZShwKX19LDUwMCk7dC5hZGQocCl9fSxnZXQ6Zj0+ZS5nZXQoZik/LnBvcHVwfX1mdW5jdGlvbiB1dCgpe2NvbnN0IGU9bmV3IE1hcDtyZXR1cm57YWRkOih7aWQ6byx1cmw6aSx0eXBlOmYsLi4uaH0pPT57aWYoZS5oYXMobykpe2oud2FybihgQW4gaWZyYW1lIHdpdGggd2l0aCBJRDonJHtvfScgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkYCk7cmV0dXJufWNvbnN0e2hlYWRlclRpdGxlOmcsaW5pdFBvc2l0aW9uOmx9PXsuLi5ofSx1PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpO3Uuc3JjPWk7Y29uc3QgcD1sPz97d2lkdGg6aXQsaGVpZ2h0OnN0fTtyZXR1cm4gZS5zZXQobyx7ZWxlbWVudDp1LHR5cGU6ZixoZWFkZXJUaXRsZTpnLGluaXRQb3NpdGlvbjpwfSksdX0scmVtb3ZlOm89PntlLmRlbGV0ZShvKX0sb3BlbixnZXQ6bz0+ZS5nZXQobyl9fWNsYXNzIGx0e2NvbnN0cnVjdG9yKHQsbil7dGhpcy50YXJnZXQ9dCx0aGlzLmNoYW5JZD1uLHRoaXMucGVuZGluZ0NhbGxzPW5ldyBNYXAsdGhpcy5ldmVudExpc3RlbmVycz1uZXcgU2V0LHRoaXMub25NZXNzYWdlPWE9PntpZihhLmRhdGEuY2hhbklkIT09dGhpcy5jaGFuSWQpcmV0dXJuO2NvbnN0IG89YS5kYXRhO2lmKGouZGVidWcoe2V2dDphfSxgTWVzc2FnZSByZWNlaXZlZCBmb3IgY2hhbm5lbCAke3RoaXMuY2hhbklkfWApLGV0KG8pKXtjb25zdFtpLGZdPXRoaXMucGVuZGluZ0NhbGxzLmdldChvLnJlcGx5VG8pPz9bXTtpZighaSl7ai5kZWJ1Zyh7ZXZ0OmF9LCJSZXNvbHZlIGZuIGRvZXNudCBleGlzdCIpO3JldHVybn10aGlzLnBlbmRpbmdDYWxscy5kZWxldGUoby5yZXBseVRvKSxpKG8ucGF5bG9hZCl9S2UobykmJnRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChpPT57aShvKX0pfSxnbG9iYWxUaGlzLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHRoaXMub25NZXNzYWdlKX1hZGRFdmVudExpc3RlbmVyKHQpe3RoaXMuZXZlbnRMaXN0ZW5lcnMuYWRkKHQpfXJlbW92ZUV2ZW50TGlzdGVuZXIodCl7dGhpcy5ldmVudExpc3RlbmVycy5kZWxldGUodCl9ZW1pdEV2ZW50KHQpe3RoaXMudGFyZ2V0LnBvc3RNZXNzYWdlKHtjaGFuSWQ6dGhpcy5jaGFuSWQsLi4udH0sIioiKX1jYWxsUlBDKHQsbixhKXtjb25zdCBvPV9lKCk7cmV0dXJuIGouZGVidWcoe3BheWxvYWQ6bixpZDpvfSxgJyR7dH0nIGNhbGxlZCBmb3IgY2hhbm5lbCAke3RoaXMuY2hhbklkfWApLG5ldyBQcm9taXNlKChpLGYpPT57dGhpcy5wZW5kaW5nQ2FsbHMuc2V0KG8sW2ksZl0pLHRoaXMudGFyZ2V0LnBvc3RNZXNzYWdlKHtycGM6dCxwYXlsb2FkOm4saWQ6byxjaGFuSWQ6dGhpcy5jaGFuSWR9LCIqIixhKX0pfXJlcGx5UlBDKHQpe3RoaXMuZW1pdEV2ZW50KHQpfXNlbmRFdmVudCh0KXt0aGlzLmVtaXRFdmVudCh0KX11bnJlZ2lzdGVyKCl7Z2xvYmFsVGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIix0aGlzLm9uTWVzc2FnZSl9Z2V0IHRhcmdldFdpbmRvdygpe3JldHVybiB0aGlzLnRhcmdldH19dmFyIEVlOyhmdW5jdGlvbihlKXtlLmF1ZGlvPSJhdWRpbyIsZS52aWRlbz0idmlkZW8iLGUuYXBpPSJhcGkifSkoRWV8fChFZT17fSkpO2FzeW5jIGZ1bmN0aW9uIGR0KGUpe3dpbmRvdy5wbHVnaW49e3BvcHVwTWFuYWdlcjpjdCgpLGlmcmFtZU1hbmFnZXI6dXQoKX07Y29uc3QgdD1uZXcgbHQod2luZG93LnBhcmVudCxfZShlLmlkKSksbj1hd2FpdCB0LmNhbGxSUEMoInN5biIsZSk7aWYoIW4uYWNrKXRocm93IG5ldyBFcnJvcihgQ2FuJ3QgcmVnaXN0ZXIgYSBwbHVnaW4uICR7SlNPTi5zdHJpbmdpZnkobil9YCk7Y29uc3QgYT1uZXcgTWFwLG89bmV3IE1hcCxpPW5ldyBNYXAsZj1uZXcgTWFwLGg9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLGc9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLGw9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHU9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHA9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLGI9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLFA9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLG09eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLGM9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHM9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHc9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLEE9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLFI9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHo9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLCQ9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHBlPXkoe2FsbG93RW1pdHRpbmdXaXRob3V0T2JzZXJ2ZXI6ITB9KSxmZT15KHthbGxvd0VtaXR0aW5nV2l0aG91dE9ic2VydmVyOiEwfSksZ2U9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLGhlPXkoe2FsbG93RW1pdHRpbmdXaXRob3V0T2JzZXJ2ZXI6ITB9KSxtZT15KHthbGxvd0VtaXR0aW5nV2l0aG91dE9ic2VydmVyOiEwfSksd2U9eSh7YWxsb3dFbWl0dGluZ1dpdGhvdXRPYnNlcnZlcjohMH0pLHllPXkoe2FsbG93RW1pdHRpbmdXaXRob3V0T2JzZXJ2ZXI6ITB9KTt0LmFkZEV2ZW50TGlzdGVuZXIocj0+e3N3aXRjaChyLmV2ZW50KXtjYXNlInVpOmJ1dHRvbjpjbGljayI6YS5nZXQoci5wYXlsb2FkLmJ1dHRvbklkKT8ub25DbGljay5lbWl0KHIucGF5bG9hZC5pbnB1dCk7YnJlYWs7Y2FzZSJ1aTpmb3JtOmlucHV0IjppLmdldChyLnBheWxvYWQubW9kYWxJZCk/Lm9uSW5wdXQuZW1pdChyLnBheWxvYWQuaW5wdXQpO2JyZWFrO2Nhc2UidWk6cHJvbXB0OmlucHV0IjpmLmdldChyLnBheWxvYWQubW9kYWxJZCk/Lm9uSW5wdXQuZW1pdChyLnBheWxvYWQuaW5wdXQpO2JyZWFrO2Nhc2UicGFydGljaXBhbnQ6ZGlzY29ubmVjdGVkIjpvLmdldChyLnBheWxvYWQucGFydGljaXBhbnRVdWlkKT8ub25EaXNjb25uZWN0LmVtaXQoKSxvLmRlbGV0ZShyLnBheWxvYWQucGFydGljaXBhbnRVdWlkKTticmVhaztjYXNlImV2ZW50OmNvbmZlcmVuY2VTdGF0dXMiOmcuZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6Y29ubmVjdGVkIjpsLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OmRpc2Nvbm5lY3RlZCI6dS5lbWl0KHIucGF5bG9hZCk7YnJlYWs7Y2FzZSJldmVudDp1c2VySW5pdGlhdGVkRGlzY29ubmVjdCI6cC5lbWl0KHIucGF5bG9hZCk7YnJlYWs7Y2FzZSJldmVudDptZSI6Yi5lbWl0KHIucGF5bG9hZCk7YnJlYWs7Y2FzZSJldmVudDptZXNzYWdlIjp3LmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OmRpcmVjdE1lc3NhZ2UiOkEuZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6YXBwbGljYXRpb25NZXNzYWdlIjpSLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OnRyYW5zZmVyIjp6LmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OmNhbmNlbFRyYW5zZmVyIjokLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OnN0YWdlIjpwZS5lbWl0KHIucGF5bG9hZCk7YnJlYWs7Y2FzZSJldmVudDpwYXJ0aWNpcGFudHMiOlAuZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6cGFydGljaXBhbnRMZWZ0IjpjLmVtaXQoci5wYXlsb2FkKSxvLmdldChyLnBheWxvYWQucGFydGljaXBhbnQudXVpZCk/Lm9uRGlzY29ubmVjdC5lbWl0KCksby5kZWxldGUoci5wYXlsb2FkLnBhcnRpY2lwYW50LnV1aWQpO2JyZWFrO2Nhc2UiZXZlbnQ6cGFydGljaXBhbnRKb2luZWQiOm0uZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6cmFpc2VIYW5kIjpzLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OnByZXNlbnRhdGlvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZSI6ZmUuZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6bGF5b3V0VXBkYXRlIjpnZS5lbWl0KHIucGF5bG9hZCk7YnJlYWs7Y2FzZSJldmVudDpjb25mZXJlbmNlOmF1dGhlbnRpY2F0ZWQiOmguZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6YnJlYWtvdXRCZWdpbiI6aGUuZW1pdChyLnBheWxvYWQpO2JyZWFrO2Nhc2UiZXZlbnQ6YnJlYWtvdXRFbmQiOm1lLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50OmJyZWFrb3V0UmVmZXIiOndlLmVtaXQoci5wYXlsb2FkKTticmVhaztjYXNlImV2ZW50Omxhbmd1YWdlU2VsZWN0Ijp5ZS5lbWl0KHIucGF5bG9hZCk7YnJlYWt9fSk7Y29uc3QgQj1hc3luYyhyLGQpPT57Y29uc3Qgaz1hd2FpdCB0LmNhbGxSUEMoInVpOnJlbW92ZUVsZW1lbnQiLHtpZDpyfSk7aWYoay5zdGF0dXM9PT0iZmFpbGVkIilyZXR1cm4gUHJvbWlzZS5yZWplY3Qoe3JlYXNvbjprLnJlYXNvbn0pO2QmJmQoKX07cmV0dXJue3VpOnthZGRCdXR0b246YXN5bmMgcj0+e2NvbnN0IGQ9YXdhaXQgdC5jYWxsUlBDKCJ1aTpidXR0b246YWRkIixyKTtpZihkLnN0YXR1cz09PSJmYWlsZWQiKXJldHVybiBQcm9taXNlLnJlamVjdCh7cmVhc29uOmQucmVhc29ufSk7Y29uc3Qgaz17b25DbGljazp5KHthbGxvd0VtaXR0aW5nV2l0aG91dE9ic2VydmVyOiEwfSksdXBkYXRlOmFzeW5jIFQ9Pntjb25zdCBJPWF3YWl0IHQuY2FsbFJQQygidWk6YnV0dG9uOnVwZGF0ZSIsey4uLlQsdGFyZ2V0SWQ6ZC5pZH0pO3JldHVybiBJLnN0YXR1cz09PSJmYWlsZWQiP1Byb21pc2UucmVqZWN0KHtyZWFzb246SS5yZWFzb259KTpJLmRhdGF9LHJlbW92ZTooKT0+QihkLmlkLCgpPT5hLmRlbGV0ZShkLmlkKSl9O3JldHVybiBhLnNldChkLmlkLGspLGt9LGFkZEZvcm06YXN5bmMgcj0+e2NvbnN0IGQ9YXdhaXQgdC5jYWxsUlBDKCJ1aTpmb3JtOm9wZW4iLHIpO2lmKGQuc3RhdHVzPT09ImZhaWxlZCIpcmV0dXJuIFByb21pc2UucmVqZWN0KHtyZWFzb246ZC5yZWFzb259KTtjb25zdCBrPXtvbklucHV0OnkoKSxyZW1vdmU6KCk9PkIoZC5pZCwoKT0+aS5kZWxldGUoZC5pZCkpfTtyZXR1cm4gaS5zZXQoZC5pZCxrKSxrfSxzaG93Rm9ybTphc3luYyByPT57Y29uc3QgZD1hd2FpdCB0LmNhbGxSUEMoInVpOmZvcm06b3BlbiIscik7cmV0dXJuIGQuc3RhdHVzPT09ImZhaWxlZCI/UHJvbWlzZS5yZWplY3Qoe3JlYXNvbjpkLnJlYXNvbn0pOm5ldyBQcm9taXNlKGs9Pntjb25zdCBUPUk9PntJLmV2ZW50PT09InVpOmZvcm06aW5wdXQiJiZJLnBheWxvYWQubW9kYWxJZD09PWQuaWQmJihrKEkucGF5bG9hZC5pbnB1dCksQihkLmlkKSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoVCkpfTt0LmFkZEV2ZW50TGlzdGVuZXIoVCl9KX0sYWRkUHJvbXB0OmFzeW5jIHI9Pntjb25zdCBkPWF3YWl0IHQuY2FsbFJQQygidWk6cHJvbXB0Om9wZW4iLHIpO2lmKGQuc3RhdHVzPT09ImZhaWxlZCIpcmV0dXJuIFByb21pc2UucmVqZWN0KHtyZWFzb246ZC5yZWFzb259KTtjb25zdCBrPXtvbklucHV0OnkoKSxyZW1vdmU6KCk9PkIoZC5pZCwoKT0+Zi5kZWxldGUoZC5pZCkpfTtyZXR1cm4gZi5zZXQoZC5pZCxrKSxrfSxzaG93UHJvbXB0OmFzeW5jIHI9Pntjb25zdCBkPWF3YWl0IHQuY2FsbFJQQygidWk6cHJvbXB0Om9wZW4iLHIpO3JldHVybiBkLnN0YXR1cz09PSJmYWlsZWQiP1Byb21pc2UucmVqZWN0KHtyZWFzb246ZC5yZWFzb259KTpuZXcgUHJvbWlzZShrPT57Y29uc3QgVD1JPT57SS5ldmVudD09PSJ1aTpwcm9tcHQ6aW5wdXQiJiZJLnBheWxvYWQubW9kYWxJZD09PWQuaWQmJihrKEkucGF5bG9hZC5pbnB1dCksQihkLmlkKSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoVCkpfTt0LmFkZEV2ZW50TGlzdGVuZXIoVCl9KX0sc2hvd1RvYXN0OmFzeW5jIHI9Pntjb25zdCBkPWF3YWl0IHQuY2FsbFJQQygidWk6dG9hc3Q6c2hvdyIscik7aWYoZC5zdGF0dXM9PT0iZmFpbGVkIilyZXR1cm4gUHJvbWlzZS5yZWplY3Qoe3JlYXNvbjpkLnJlYXNvbn0pfSx0b2dnbGVQbHVnaW46YXN5bmMgcj0+e2NvbnN0IGQ9YXdhaXQgdC5jYWxsUlBDKCJ1aTpwbHVnaW46dG9nZ2xlIixyKTtpZihkLnN0YXR1cz09PSJmYWlsZWQiKXJldHVybiBQcm9taXNlLnJlamVjdCh7cmVhc29uOmQucmVhc29ufSl9fSxjb25mZXJlbmNlOntkaWFsT3V0OmFzeW5jIHI9PntsZXQgZDtjb25zdCBrPW5ldyBNYXA7bGV0IFQ9KCk9Pnt9O2NvbnN0IEk9bmV3IFByb21pc2UoemU9PntUPW0uYWRkKCh7cGFydGljaXBhbnQ6R30pPT57ZD9kLmRhdGEucmVzdWx0LmluY2x1ZGVzKEcudXVpZCkmJnplKEcpOmsuc2V0KEcudXVpZCxHKX0pfSk7ZD1hd2FpdCB0LmNhbGxSUEMoImNvbmZlcmVuY2U6ZGlhbE91dCIscik7Y29uc3QgVj1kPy5kYXRhLnJlc3VsdFswXTtpZighVil0aHJvdyBFcnJvcigiQ291bGQgbm90IGRpYWwgb3V0IHRvIHNwZWNpZmllZCB1cmkiKTtjb25zdCBIZT1rLmdldChWKT8/YXdhaXQgSTtUKCk7Y29uc3QgdmU9ey4uLkhlLG9uRGlzY29ubmVjdDp5KHthbGxvd0VtaXR0aW5nV2l0aG91dE9ic2VydmVyOiEwfSksZGlzY29ubmVjdDphc3luYygpPT4oby5kZWxldGUoViksdC5jYWxsUlBDKCJwYXJ0aWNpcGFudDpkaXNjb25uZWN0Iix7cGFydGljaXBhbnRVdWlkOlZ9KSl9O3JldHVybiBvLnNldChWLHZlKSx2ZX0sc2VuZE1lc3NhZ2U6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOnNlbmRNZXNzYWdlIixyKSxzZW5kQXBwbGljYXRpb25NZXNzYWdlOmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpzZW5kQXBwbGljYXRpb25NZXNzYWdlIixyKSxsb2NrOmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpsb2NrIixyKSxtdXRlQWxsR3Vlc3RzOmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTptdXRlQWxsR3Vlc3RzIixyKSxzZXRCYW5kd2lkdGg6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOnNldEJhbmR3aWR0aCIsciksc2V0TGF5b3V0OmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpzZXRMYXlvdXQiLHIpLGRpc2Nvbm5lY3RBbGw6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOmRpc2Nvbm5lY3RBbGwiLHIpLHJlcXVlc3RQYXJ0aWNpcGFudHM6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOnJlcXVlc3RQYXJ0aWNpcGFudHMiLHIpLHNlbmRSZXF1ZXN0OmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpzZW5kUmVxdWVzdCIsciksdHJhbnNmZXI6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJwYXJ0aWNpcGFudDp0cmFuc2ZlciIsciksbXV0ZTphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50Om11dGUiLHIpLG11dGVWaWRlbzphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50Om11dGVWaWRlbyIsciksc3BvdGxpZ2h0OmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygicGFydGljaXBhbnQ6c3BvdGxpZ2h0IixyKSxhZG1pdDphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50OmFkbWl0IixyKSxyYWlzZUhhbmQ6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJwYXJ0aWNpcGFudDpyYWlzZUhhbmQiLHIpLHNldFJvbGU6YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJwYXJ0aWNpcGFudDpzZXRSb2xlIixyKSxzZXRUZXh0T3ZlcmxheTphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50OnNldFRleHRPdmVybGF5IixyKSxzZW5kRFRNRjphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50OnNlbmREVE1GIixyKSxkaXNjb25uZWN0OmFzeW5jIHI9Pntjb25zdCBkPXIucGFydGljaXBhbnRVdWlkO3JldHVybiBvLmRlbGV0ZShkKSxhd2FpdCB0LmNhbGxSUEMoInBhcnRpY2lwYW50OmRpc2Nvbm5lY3QiLHtwYXJ0aWNpcGFudFV1aWQ6ZH0pfSxicmVha291dDphc3luYyByPT5hd2FpdCB0LmNhbGxSUEMoImNvbmZlcmVuY2U6YnJlYWtvdXQiLHIpLGpvaW5CcmVha291dFJvb206YXN5bmMgcj0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOmpvaW5CcmVha291dFJvb20iLHIpLGNsb3NlQnJlYWtvdXRzOmFzeW5jKCk9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpjbG9zZUJyZWFrb3V0cyIse30pLGNsb3NlQnJlYWtvdXRSb29tOmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpjbG9zZUJyZWFrb3V0Um9vbSIsciksZW1wdHlCcmVha291dHM6YXN5bmMoKT0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOmVtcHR5QnJlYWtvdXRzIix7fSksYnJlYWtvdXRNb3ZlUGFydGljaXBhbnRzOmFzeW5jIHI9PmF3YWl0IHQuY2FsbFJQQygiY29uZmVyZW5jZTpicmVha291dE1vdmVQYXJ0aWNpcGFudHMiLHIpLGdldEN1cnJlbnRSb29tSWQ6YXN5bmMoKT0+YXdhaXQgdC5jYWxsUlBDKCJjb25mZXJlbmNlOmN1cnJlbnRSb29tSWQiLHZvaWQgMCl9LGV2ZW50czp7YXV0aGVudGljYXRlZFdpdGhDb25mZXJlbmNlOmgsY29uZmVyZW5jZVN0YXR1czpnLGNvbm5lY3RlZDpsLGRpc2Nvbm5lY3RlZDp1LHVzZXJJbml0aWF0ZWREaXNjb25uZWN0OnAsbWU6YixtZXNzYWdlOncsZGlyZWN0TWVzc2FnZTpBLGFwcGxpY2F0aW9uTWVzc2FnZTpSLHRyYW5zZmVyOnosY2FuY2VsVHJhbnNmZXI6JCxzdGFnZTpwZSxwYXJ0aWNpcGFudHM6UCxwYXJ0aWNpcGFudEpvaW5lZDptLHBhcnRpY2lwYW50TGVmdDpjLHJhaXNlSGFuZDpzLHByZXNlbnRhdGlvbkNvbm5lY3Rpb25TdGF0ZUNoYW5nZTpmZSxsYXlvdXRVcGRhdGU6Z2UsYnJlYWtvdXRCZWdpbjpoZSxicmVha291dEVuZDptZSxicmVha291dFJlZmVyOndlLGxhbmd1YWdlU2VsZWN0OnllfX19ZnVuY3Rpb24gcHQoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZSYmT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRlZmF1bHQiKT9lLmRlZmF1bHQ6ZX12YXIgdGU9e2V4cG9ydHM6e319LGtlO2Z1bmN0aW9uIGZ0KCl7cmV0dXJuIGtlfHwoa2U9MSxmdW5jdGlvbihlKXt2YXIgdD1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LG49In4iO2Z1bmN0aW9uIGEoKXt9T2JqZWN0LmNyZWF0ZSYmKGEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobnVsbCksbmV3IGEoKS5fX3Byb3RvX198fChuPSExKSk7ZnVuY3Rpb24gbyhnLGwsdSl7dGhpcy5mbj1nLHRoaXMuY29udGV4dD1sLHRoaXMub25jZT11fHwhMX1mdW5jdGlvbiBpKGcsbCx1LHAsYil7aWYodHlwZW9mIHUhPSJmdW5jdGlvbiIpdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhlIGxpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbiIpO3ZhciBQPW5ldyBvKHUscHx8ZyxiKSxtPW4/bitsOmw7cmV0dXJuIGcuX2V2ZW50c1ttXT9nLl9ldmVudHNbbV0uZm4/Zy5fZXZlbnRzW21dPVtnLl9ldmVudHNbbV0sUF06Zy5fZXZlbnRzW21dLnB1c2goUCk6KGcuX2V2ZW50c1ttXT1QLGcuX2V2ZW50c0NvdW50KyspLGd9ZnVuY3Rpb24gZihnLGwpey0tZy5fZXZlbnRzQ291bnQ9PT0wP2cuX2V2ZW50cz1uZXcgYTpkZWxldGUgZy5fZXZlbnRzW2xdfWZ1bmN0aW9uIGgoKXt0aGlzLl9ldmVudHM9bmV3IGEsdGhpcy5fZXZlbnRzQ291bnQ9MH1oLnByb3RvdHlwZS5ldmVudE5hbWVzPWZ1bmN0aW9uKCl7dmFyIGw9W10sdSxwO2lmKHRoaXMuX2V2ZW50c0NvdW50PT09MClyZXR1cm4gbDtmb3IocCBpbiB1PXRoaXMuX2V2ZW50cyl0LmNhbGwodSxwKSYmbC5wdXNoKG4/cC5zbGljZSgxKTpwKTtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scz9sLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHUpKTpsfSxoLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24obCl7dmFyIHU9bj9uK2w6bCxwPXRoaXMuX2V2ZW50c1t1XTtpZighcClyZXR1cm5bXTtpZihwLmZuKXJldHVybltwLmZuXTtmb3IodmFyIGI9MCxQPXAubGVuZ3RoLG09bmV3IEFycmF5KFApO2I8UDtiKyspbVtiXT1wW2JdLmZuO3JldHVybiBtfSxoLnByb3RvdHlwZS5saXN0ZW5lckNvdW50PWZ1bmN0aW9uKGwpe3ZhciB1PW4/bitsOmwscD10aGlzLl9ldmVudHNbdV07cmV0dXJuIHA/cC5mbj8xOnAubGVuZ3RoOjB9LGgucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24obCx1LHAsYixQLG0pe3ZhciBjPW4/bitsOmw7aWYoIXRoaXMuX2V2ZW50c1tjXSlyZXR1cm4hMTt2YXIgcz10aGlzLl9ldmVudHNbY10sdz1hcmd1bWVudHMubGVuZ3RoLEEsUjtpZihzLmZuKXtzd2l0Y2gocy5vbmNlJiZ0aGlzLnJlbW92ZUxpc3RlbmVyKGwscy5mbix2b2lkIDAsITApLHcpe2Nhc2UgMTpyZXR1cm4gcy5mbi5jYWxsKHMuY29udGV4dCksITA7Y2FzZSAyOnJldHVybiBzLmZuLmNhbGwocy5jb250ZXh0LHUpLCEwO2Nhc2UgMzpyZXR1cm4gcy5mbi5jYWxsKHMuY29udGV4dCx1LHApLCEwO2Nhc2UgNDpyZXR1cm4gcy5mbi5jYWxsKHMuY29udGV4dCx1LHAsYiksITA7Y2FzZSA1OnJldHVybiBzLmZuLmNhbGwocy5jb250ZXh0LHUscCxiLFApLCEwO2Nhc2UgNjpyZXR1cm4gcy5mbi5jYWxsKHMuY29udGV4dCx1LHAsYixQLG0pLCEwfWZvcihSPTEsQT1uZXcgQXJyYXkody0xKTtSPHc7UisrKUFbUi0xXT1hcmd1bWVudHNbUl07cy5mbi5hcHBseShzLmNvbnRleHQsQSl9ZWxzZXt2YXIgej1zLmxlbmd0aCwkO2ZvcihSPTA7Ujx6O1IrKylzd2l0Y2goc1tSXS5vbmNlJiZ0aGlzLnJlbW92ZUxpc3RlbmVyKGwsc1tSXS5mbix2b2lkIDAsITApLHcpe2Nhc2UgMTpzW1JdLmZuLmNhbGwoc1tSXS5jb250ZXh0KTticmVhaztjYXNlIDI6c1tSXS5mbi5jYWxsKHNbUl0uY29udGV4dCx1KTticmVhaztjYXNlIDM6c1tSXS5mbi5jYWxsKHNbUl0uY29udGV4dCx1LHApO2JyZWFrO2Nhc2UgNDpzW1JdLmZuLmNhbGwoc1tSXS5jb250ZXh0LHUscCxiKTticmVhaztkZWZhdWx0OmlmKCFBKWZvcigkPTEsQT1uZXcgQXJyYXkody0xKTskPHc7JCsrKUFbJC0xXT1hcmd1bWVudHNbJF07c1tSXS5mbi5hcHBseShzW1JdLmNvbnRleHQsQSl9fXJldHVybiEwfSxoLnByb3RvdHlwZS5vbj1mdW5jdGlvbihsLHUscCl7cmV0dXJuIGkodGhpcyxsLHUscCwhMSl9LGgucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24obCx1LHApe3JldHVybiBpKHRoaXMsbCx1LHAsITApfSxoLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbihsLHUscCxiKXt2YXIgUD1uP24rbDpsO2lmKCF0aGlzLl9ldmVudHNbUF0pcmV0dXJuIHRoaXM7aWYoIXUpcmV0dXJuIGYodGhpcyxQKSx0aGlzO3ZhciBtPXRoaXMuX2V2ZW50c1tQXTtpZihtLmZuKW0uZm49PT11JiYoIWJ8fG0ub25jZSkmJighcHx8bS5jb250ZXh0PT09cCkmJmYodGhpcyxQKTtlbHNle2Zvcih2YXIgYz0wLHM9W10sdz1tLmxlbmd0aDtjPHc7YysrKShtW2NdLmZuIT09dXx8YiYmIW1bY10ub25jZXx8cCYmbVtjXS5jb250ZXh0IT09cCkmJnMucHVzaChtW2NdKTtzLmxlbmd0aD90aGlzLl9ldmVudHNbUF09cy5sZW5ndGg9PT0xP3NbMF06czpmKHRoaXMsUCl9cmV0dXJuIHRoaXN9LGgucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycz1mdW5jdGlvbihsKXt2YXIgdTtyZXR1cm4gbD8odT1uP24rbDpsLHRoaXMuX2V2ZW50c1t1XSYmZih0aGlzLHUpKToodGhpcy5fZXZlbnRzPW5ldyBhLHRoaXMuX2V2ZW50c0NvdW50PTApLHRoaXN9LGgucHJvdG90eXBlLm9mZj1oLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcixoLnByb3RvdHlwZS5hZGRMaXN0ZW5lcj1oLnByb3RvdHlwZS5vbixoLnByZWZpeGVkPW4saC5FdmVudEVtaXR0ZXI9aCxlLmV4cG9ydHM9aH0odGUpKSx0ZS5leHBvcnRzfXZhciBndD1mdCgpO2NvbnN0IEFlPXB0KGd0KTtsZXQgRTtjb25zdCBodD1lPT57RT1lfTtsZXQgWT17Y29uZmVyZW5jZUFsaWFzOiIiLGNvbmZlcmVuY2VOYW1lOnZvaWQgMH07Y29uc3QgbXQ9KGUsdCk9PntZPXtjb25mZXJlbmNlQWxpYXM6ZSxjb25mZXJlbmNlTmFtZTp0fX0sQ2U9YXN5bmMgZT0+e2F3YWl0IEUuY29uZmVyZW5jZS5zZXRMYXlvdXQoe3RyYW5zZm9ybXM6e3JlY29yZGluZ19pbmRpY2F0b3I6ZX19KX0sd3Q9YXN5bmMgZT0+e3RyeXthd2FpdCBFLmNvbmZlcmVuY2Uuc2V0Um9sZSh7cm9sZToiY2hhaXIiLHBhcnRpY2lwYW50VXVpZDplfSksYXdhaXQgRS5jb25mZXJlbmNlLnNldFJvbGUoe3JvbGU6Imd1ZXN0IixwYXJ0aWNpcGFudFV1aWQ6ZX0pfWNhdGNoe319LHl0PWF3YWl0IGZldGNoKCIuL2NvbmZpZy5qc29uIiksdj1hd2FpdCB5dC5qc29uKCksT2U9InBleGlwLXZicmljayI7dmFyIE49KGU9PihlLlVzZXI9YCR7T2V9OnVzZXJgLGUuUmVjb3JkaW5nPWAke09lfTpyZWNvcmRpbmdgLGUpKShOfHx7fSk7ZnVuY3Rpb24gVGUoZSl7dHJ5e2NvbnN0IHQ9Z2xvYmFsVGhpcy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShlKTtpZih0IT1udWxsKXJldHVybiBKU09OLnBhcnNlKHQpfWNhdGNoe31yZXR1cm4gbnVsbH1mdW5jdGlvbiBhZShlLHQpe3RyeXt0PT1udWxsP2dsb2JhbFRoaXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZSk6Z2xvYmFsVGhpcy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShlLEpTT04uc3RyaW5naWZ5KHQpKX1jYXRjaHt9fWxldCBPPVRlKE4uVXNlcik7Y29uc3QgaWU9ZT0+e089ZSxhZShOLlVzZXIsTyl9O2xldCByZT0iIjtjb25zdCBVZT0yMCxNZT0xODAwO2xldCBKPTA7Y29uc3QgdnQ9YXN5bmMoKT0+e2NvbnN0IGU9Ii9hcGkvdjIvb2F1dGgyL2F1dGhvcml6ZSIsdD1uZXcgVVJMKGUsdi52YnJpY2sudXJsKTtyZXR1cm4gdC5zZWFyY2hQYXJhbXMuc2V0KCJjbGllbnRfaWQiLHYudmJyaWNrLmNsaWVudF9pZCksdC5zZWFyY2hQYXJhbXMuc2V0KCJjb2RlX2NoYWxsZW5nZSIsYXdhaXQgT3QoKSksdC5zZWFyY2hQYXJhbXMuc2V0KCJyZXNwb25zZV90eXBlIiwiY29kZSIpLHQuc2VhcmNoUGFyYW1zLnNldCgicmVkaXJlY3RfdXJpIix2LnZicmljay5yZWRpcmVjdF91cmkpLHQudG9TdHJpbmcoKX0sYnQ9YXN5bmMgZT0+e2NvbnN0IHQ9Ii9hcGkvdjIvb2F1dGgyL3Rva2VuIixuPW5ldyBVUkwodCx2LnZicmljay51cmwpLGE9e2NvZGU6ZS5yZXBsYWNlKC8gL2csIisiKSxncmFudF90eXBlOiJhdXRob3JpemF0aW9uX2NvZGUiLGNsaWVudF9pZDp2LnZicmljay5jbGllbnRfaWQscmVkaXJlY3RfdXJpOnYudmJyaWNrLnJlZGlyZWN0X3VyaSxjb2RlX3ZlcmlmaWVyOnJlfSxpPWF3YWl0KGF3YWl0IGZldGNoKG4se21ldGhvZDoiUE9TVCIsYm9keTpKU09OLnN0cmluZ2lmeShhKSxoZWFkZXJzOnsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24vanNvbiJ9fSkpLmpzb24oKTtpLmV4cGlyYXRpb249bmV3IERhdGUoRGF0ZS5ub3coKStpLmV4cGlyZXNfaW4qMWUzKSxpZShpKSxKPT09MCYmV2UoTz8uZXhwaXJlc19pbj8/TWUtVWUpLEsuZW1pdCgibG9naW4iKX0sUnQ9KCk9Pk8/LmFjY2Vzc190b2tlbj8/IiIsUHQ9KCk9Pk8sWj0oKT0+TyE9bnVsbCYmTy5hY2Nlc3NfdG9rZW4hPT0iIixzZT0oKT0+KHthdXRob3JpemF0aW9uOmB2YnJpY2sgJHtPPy5hY2Nlc3NfdG9rZW59YH0pLCRlPWFzeW5jKCk9PntpZihPPT1udWxsfHwhWigpKXRocm93IG5ldyBFcnJvcigiQ2Fubm90IHJlY292ZXIgdGhlIHVzZXIgaW5mbyBmcm9tIHRoZSBsb2NhbFN0b3JhZ2UiKTtjb25zdCBlPSIvYXBpL3YyL3VzZXIvZXh0ZW5kLXNlc3Npb24iLHQ9bmV3IFVSTChlLHYudmJyaWNrLnVybCksbj1hd2FpdCBmZXRjaCh0LHttZXRob2Q6IlBPU1QiLGhlYWRlcnM6c2UoKX0pLHtleHBpcmF0aW9uOmF9PWF3YWl0IG4uanNvbigpLG89bmV3IERhdGUoYSkuZ2V0VGltZSgpLURhdGUubm93KCk7Ty5leHBpcmVzX2luPWlzTmFOKG8pP01lOk1hdGguZmxvb3Ioby8xZTMpLGllKE8pLEo9PT0wJiZXZShPLmV4cGlyZXNfaW4tVWUpLEsuZW1pdCgicmVmcmVzaGVkX3Rva2VuIil9LEV0PWFzeW5jKCk9Pntjb25zdCBlPSIvYXBpL3YyL3VzZXIvc2Vzc2lvbiIsdD1uZXcgVVJMKGUsdi52YnJpY2sudXJsKTtyZXR1cm4gWigpPyhhd2FpdCBmZXRjaCh0LHtoZWFkZXJzOnNlKCl9KS5jYXRjaChhPT57Y29uc29sZS5lcnJvcihhKX0pKT8uc3RhdHVzPT09MjAwOiExfSxrdD1hc3luYygpPT57Y29uc3QgZT0iL2FwaS92Mi91c2VyL2xvZ29mZiIsdD1uZXcgVVJMKGUsdi52YnJpY2sudXJsKTtPIT1udWxsJiZaKCkmJmF3YWl0IGZldGNoKHQse21ldGhvZDoiUE9TVCIsYm9keTpKU09OLnN0cmluZ2lmeSh7dXNlcklkOk8udXNlcklkfSksaGVhZGVyczp7Li4uc2UoKSwiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24vanNvbiJ9fSkuY2F0Y2gobj0+e2NvbnNvbGUud2FybihuKX0pLHhlKCksQ3QoKSxLLmVtaXQoImxvZ291dCIpfSx4ZT0oKT0+e2llKG51bGwpfSxXZT1lPT57Sj1zZXRJbnRlcnZhbCgoKT0+eyRlKCkuY2F0Y2godD0+e2NvbnNvbGUuZXJyb3IodCl9KX0sZSoxZTMpfSxDdD0oKT0+e2NsZWFySW50ZXJ2YWwoSiksSj0wfSxLPW5ldyBBZSxTPXtnZXRBdXRoVXJsOnZ0LGNyZWF0ZUFjY2Vzc1Rva2VuOmJ0LGdldEFjY2Vzc1Rva2VuOlJ0LGdldFVzZXI6UHQsaXNBdXRoZW50aWNhdGVkOloscmVmcmVzaEFjY2Vzc1Rva2VuOiRlLGlzU2Vzc2lvblZhbGlkOkV0LGxvZ291dDprdCxjbGVhblNlc3Npb246eGUsZW1pdHRlcjpLfSxPdD1hc3luYygpPT4ocmU9SXQoNDgpLGF3YWl0IFN0KHJlKSksSXQ9ZT0+e2NvbnN0IHQ9Y3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShlLzIpKTtyZXR1cm4gQXJyYXkuZnJvbSh0KS5tYXAobj0+bi50b1N0cmluZygxNikucGFkU3RhcnQoMiwiMCIpKS5qb2luKCIiKX0sU3Q9YXN5bmMgZT0+e2NvbnN0IHQ9bmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGUpLG49YXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoIlNIQS0yNTYiLHQpLGE9U3RyaW5nLmZyb21DaGFyQ29kZSguLi5uZXcgVWludDhBcnJheShuKSk7cmV0dXJuIGJ0b2EoYSkucmVwbGFjZSgvXC8vZywiXyIpLnJlcGxhY2UoL1wrL2csIi0iKS5yZXBsYWNlKC89KyQvLCIiKX0sX3Q9ZT0+e2NvbnN0e2RhdGE6e3NlYXJjaDp0fX09ZTtpZih0IT1udWxsJiZ0IT09IiIpe2NvbnN0IG49bmV3IFVSTFNlYXJjaFBhcmFtcyh0KS5nZXQoImNvZGUiKTtuIT1udWxsJiYoY29uc29sZS5sb2coImNvZGUiLG4pLFMuY3JlYXRlQWNjZXNzVG9rZW4obikuY2F0Y2goY29uc29sZS5lcnJvcikpfX07d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLF90KTthc3luYyBmdW5jdGlvbiBGKGUsdCxuKXtjb25zdHt0aW1lb3V0U2Vjb25kczphPTB9PW4/P3t9LG89QXQobix0KTt0cnl7Y29uc3QgaT1hPjA/YXdhaXQgY2UoZmV0Y2goZSxvKSxhKTphd2FpdCBmZXRjaChlLG8pO3JldHVybiBpLnN0YXR1cyE9PTIwMD97c3VjY2VzczohMSxlcnJvcjpgJHtpLnN0YXR1c30gJHtpLnN0YXR1c1RleHR9YH06e3N1Y2Nlc3M6ITAsZGF0YTphd2FpdCBpLmpzb24oKS5jYXRjaCgoKT0+e30pfX1jYXRjaChpKXtyZXR1cm57c3VjY2VzczohMSxlcnJvcjppPy50b1N0cmluZz8uKCk/PyJSZXF1ZXN0IEZhaWxlZCJ9fX1mdW5jdGlvbiBBdChlLHQpe2NvbnN0IG49bmV3IEhlYWRlcnMoZT8uaGVhZGVycyksYT1TLmdldEFjY2Vzc1Rva2VuKCk7YSE9PSIiJiZuLnNldCgiYXV0aG9yaXphdGlvbiIsYFZicmljayAke2F9YCk7Y29uc3Qgbz17Li4uZSxoZWFkZXJzOm59O3JldHVybiB0PT1udWxsfHwoL3B1dHxwb3N0fHBhdGNoL2kudGVzdChvLm1ldGhvZD8/IiIpPyhuLnNldCgiY29udGVudC10eXBlIiwiYXBwbGljYXRpb24vanNvbiIpLG8uYm9keT1KU09OLnN0cmluZ2lmeSh0KSk6T2JqZWN0LmVudHJpZXModCkuZm9yRWFjaCgoW2ksZl0pPT57bi5zZXQoaSxmKX0pKSxvfWFzeW5jIGZ1bmN0aW9uIGNlKGUsdCl7bGV0IG49LTE7cmV0dXJuIGF3YWl0IFByb21pc2UucmFjZShbZSxuZXcgUHJvbWlzZSgoYSxvKT0+e249c2V0VGltZW91dCgoKT0+e28obmV3IERPTUV4Y2VwdGlvbigiVGltZW91dCIsIlRpbWVvdXRFcnJvciIpKX0sdCoxZTMpfSldKS5maW5hbGx5KCgpPT57Y2xlYXJUaW1lb3V0KG4pfSl9bGV0IGplPVtdO2NvbnN0IFR0PWU9PntqZT1lfSxEZT1lPT5qZS5maW5kKGUpLFV0PSh7c2VydmljZVR5cGU6ZX0sdD0hMSk9PnQ/ZT09PSJjb25uZWN0aW5nIj8iQ29ubmVjdGluZ0ZhaWxlZCI6IlJlY29yZGluZ0ZpbmlzaGVkIjplPT09ImNvbm5lY3RpbmciPyJXYWl0aW5nRm9yU3RyZWFtIjoiUmVjb3JkaW5nIixNdD1hc3luYyhlPTE1KT0+e2NvbnN0IHQ9UHJvbWlzZS5hbGwoW25ldyBQcm9taXNlKG49PkUuZXZlbnRzLnBhcnRpY2lwYW50cy5hZGRPbmNlKCgpPT57bigpfSkpLG5ldyBQcm9taXNlKG49PkUuZXZlbnRzLmF1dGhlbnRpY2F0ZWRXaXRoQ29uZmVyZW5jZS5hZGRPbmNlKCgpPT57bigpfSkpXSk7YXdhaXQgY2UodCxlKX07bGV0IF89VGUoTi5SZWNvcmRpbmcpO2NvbnN0IE5lPShlPW51bGwpPT57Xz1lLGFlKE4uUmVjb3JkaW5nLF8pfSxMPSgpPT5fLEZlPSgpPT57Xz1udWxsLGFlKE4uUmVjb3JkaW5nLG51bGwpfSxYPWU9PntfIT1udWxsJiZOZShPYmplY3QuYXNzaWduKF8sZSkpfSwkdD1bIlJlY29yZGluZyIsIkNvbm5lY3RpbmciLCJXYWl0aW5nRm9yU3RyZWFtIiwiUmVjb3JkaW5nU3RyZWFtIiwiU3RhcnRSZWNvcmRpbmciLCJSZWNvcmRpbmdJbml0aWFsaXppbmciLCJTdG9wUmVjb3JkaW5nIl0sTGU9KCk9Pntjb25zdCBlPXYucmVjb3JkaW5nX3R5cGU9PT0icnRtcCI/Xz8ucnRtcFN0cmVhbUtleTpfPy52aWRlb0lkO3JldHVybiBlIT1udWxsJiZlIT09IiJ9LHVlPSgpPT5MZSgpJiZ0eXBlb2YgXz8uc3RhdHVzPT0ic3RyaW5nIiYmJHQuaW5jbHVkZXMoXy5zdGF0dXMpLFE9KCk9Pl8/LnN0YXR1cz09PSJDb25uZWN0aW5nInx8Xz8uc3RhdHVzPT09IldhaXRpbmdGb3JTdHJlYW0iLHh0PSgpPT4hUSgpJiZ1ZSgpO2FzeW5jIGZ1bmN0aW9uIFd0KGUsdD02MCl7Y29uc3Qgbj0iL3JlY2FwaS92MC9ydG1wL3N0YXJ0LXJlY29yZGluZyIsYT1uZXcgVVJMKG4sdi5yZWNvcmRlci51cmwpLG89e3RpdGxlOmUscm91dGU6di5yZWNvcmRlci5yb3V0ZSwuLi5ZfSxpPWF3YWl0IEYoYSxvLHttZXRob2Q6IlBPU1QiLHRpbWVvdXRTZWNvbmRzOnR9KTtyZXR1cm4gaS5zdWNjZXNzJiZqdChpLmRhdGEucnRtcFVybCksaX1hc3luYyBmdW5jdGlvbiBqdChlKXtyZXR1cm4gYXdhaXQgRS5jb25mZXJlbmNlLmRpYWxPdXQoe2Rlc3RpbmF0aW9uOmUscHJvdG9jb2w6di5yZWNvcmRlci5sZWdhY3lfZGlhbG91dF9hcGk9PT0hMD8icnRtcCI6ImF1dG8iLHJvbGU6IkdVRVNUIixzdHJlYW1pbmc6InllcyIsLi4udi5yZWNvcmRlci5kaXNwbGF5X25hbWUhPW51bGwmJnt0ZXh0OnYucmVjb3JkZXIuZGlzcGxheV9uYW1lfX0pfWFzeW5jIGZ1bmN0aW9uIER0KHtydG1wU3RyZWFtS2V5OmV9KXtpZihlPT1udWxsfHxlPT09IiIpcmV0dXJue3N1Y2Nlc3M6ITAsZGF0YTp2b2lkIDB9O2NvbnN0IHQ9Ii9yZWNhcGkvdjAvcnRtcC9zdG9wLXJlY29yZGluZyIsbj1uZXcgVVJMKHQsdi5yZWNvcmRlci51cmwpO3JldHVybiBhd2FpdCBGKG4se3J0bXBTdHJlYW1LZXk6ZX0se21ldGhvZDoiUE9TVCJ9KX1hc3luYyBmdW5jdGlvbiBOdCh7cnRtcFN0cmVhbUtleTplfSl7Y29uc3QgdD1gL3JlY2FwaS92MC9ydG1wL3JlY29yZGluZy1zdGF0dXMvJHtlfWAsbj1uZXcgVVJMKHQsdi5yZWNvcmRlci51cmwpLGE9YXdhaXQgRihuKTtyZXR1cm4gYS5zdWNjZXNzJiZBcnJheS5pc0FycmF5KGEuZGF0YSkmJihhLmRhdGE9YS5kYXRhWzBdKSxhfWNvbnN0e2hvc3RuYW1lOkZ0fT1uZXcgVVJMKHYucmVjb3JkZXIudXJsKSxMdD0oe3VyaTplfSk9PntpZighL15ydG1wcz86XC9cLy8udGVzdChlKSlyZXR1cm4hMTtjb25zdHtydG1wVXJsOnR9PUwoKT8/e307cmV0dXJuIHQhPW51bGwmJmU9PT10PyEwOm5ldyBVUkwoZS5yZXBsYWNlKC9ecnRtcC8sImh0dHAiKSkuaG9zdG5hbWU9PT1GdH0sQnQ9e3N0YXJ0UmVjb3JkaW5nOld0LHN0b3BSZWNvcmRpbmc6RHQsZ2V0U3RhdHVzOk50LGlzUmVjb3JkaW5nUGFydGljaXBhbnQ6THR9O2FzeW5jIGZ1bmN0aW9uIFZ0KGUsdD02MCl7Y29uc3Qgbj0iL2FwaS92Mi92Yy9zdGFydC1yZWNvcmRpbmciLGE9bmV3IFVSTChuLHYudmJyaWNrLnVybCksbz12LmluZmluaXR5LnNpcF9kb21haW4saT1gJHtZLmNvbmZlcmVuY2VBbGlhc31AJHtvfWA7cmV0dXJuIGF3YWl0IEYoYSx7dGl0bGU6ZSxzaXBBZGRyZXNzOmksc2lwUGluOiIifSx7bWV0aG9kOiJQT1NUIix0aW1lb3V0U2Vjb25kczp0fSl9YXN5bmMgZnVuY3Rpb24gSnQoe3ZpZGVvSWQ6ZX0pe2NvbnN0IHQ9Ii9hcGkvdjIvdmMvc3RvcC1yZWNvcmRpbmciLG49bmV3IFVSTCh0LHYudmJyaWNrLnVybCk7cmV0dXJuIGF3YWl0IEYobix7dmlkZW9JZDplfSx7bWV0aG9kOiJQT1NUIn0pfWFzeW5jIGZ1bmN0aW9uIEh0KHt2aWRlb0lkOmV9KXtjb25zdCB0PWAvYXBpL3YyL3ZjL3JlY29yZGluZy1zdGF0dXMvJHtlfWAsbj1uZXcgVVJMKHQsdi52YnJpY2sudXJsKSxhPWF3YWl0IEYobik7cmV0dXJuIGEuc3VjY2Vzcz97c3VjY2VzczohMCxkYXRhOnt2aWRlb0lkOmUsc3RhdHVzOmEuZGF0YX19OmF9Y29uc3QgenQ9ZT0+e2NvbnN0e2hvc3RuYW1lOnR9PW5ldyBVUkwodi52YnJpY2sudXJsKSxuPWBzaXA6JHtTLmdldFVzZXIoKT8udXNlcm5hbWV9QCR7dH1gO3JldHVybiBlLnVyaT09PW59LEd0PXtzdGFydFJlY29yZGluZzpWdCxzdG9wUmVjb3JkaW5nOkp0LGdldFN0YXR1czpIdCxpc1JlY29yZGluZ1BhcnRpY2lwYW50Onp0fSxXPXYucmVjb3JkaW5nX3R5cGU9PT0icnRtcCI/QnQ6R3QscXQ9KCk9Pntjb25zdCBlPVtFLmV2ZW50cy5wYXJ0aWNpcGFudEpvaW5lZC5hZGQoYXN5bmMoe3BhcnRpY2lwYW50OnR9KT0+e1cuaXNSZWNvcmRpbmdQYXJ0aWNpcGFudCh0KSYmKFEoKSYmbmUodCksQ2UoITApLGF3YWl0IHd0KHQudXVpZCkpfSksRS5ldmVudHMucGFydGljaXBhbnRMZWZ0LmFkZCgoe3BhcnRpY2lwYW50OnR9KT0+e1cuaXNSZWNvcmRpbmdQYXJ0aWNpcGFudCh0KSYmKG5lKHQsITApLENlKCExKSl9KSxFLmV2ZW50cy5wYXJ0aWNpcGFudHMuYWRkKCh7cGFydGljaXBhbnRzOnR9KT0+e1R0KHQpLFEoKSYmbmUoKX0pXTtFLmV2ZW50cy5tZS5hZGRPbmNlKCh7cGFydGljaXBhbnQ6dH0pPT57dC5yb2xlPT09ImNoYWlyIj9YdCgpOmUuZm9yRWFjaChuPT57bigpfSl9KX07ZnVuY3Rpb24gbmUoZSx0PSExKXtjb25zdCBuPUwoKTtpZihlPz89bGUoKSxuPT1udWxsfHxlPT1udWxsfHxuLnBhcnRpY2lwYW50VXVpZCE9bnVsbCYmZS51dWlkIT09bi5wYXJ0aWNpcGFudFV1aWQpcmV0dXJuO2NvbnN0IGE9VXQoZSx0KTtuLnN0YXR1cyE9PWEmJihYKHtzdGF0dXM6YSxwYXJ0aWNpcGFudFV1aWQ6ZS51dWlkfSksTS5lbWl0KCJjaGFuZ2VkIikpfWFzeW5jIGZ1bmN0aW9uIFh0KCl7aWYoISghdWUoKXx8ZGUoKSkpe3RyeXthd2FpdCBNdCgxNSkuY2F0Y2goYT0+e2NvbnNvbGUud2FybigiVGltZW91dCB3YWl0aW5nIGZvciBwYXJ0aWNpcGFudCBsaXN0IG9uIGZpcnN0IGpvaW4iLGEpfSk7Y29uc3QgZT1MKCksdD1sZSgpLG49dCE9bnVsbCYmZT8ucGFydGljaXBhbnRVdWlkPT09dC51dWlkO2lmKHh0KCkmJm4pcmV0dXJufWNhdGNoKGUpe2NvbnNvbGUuZXJyb3IoIkZhaWxlZCB0byByZWZyZXNoIHJlY29yZGluZyBzdGF0dXMiLGUpfUZlKCksTS5lbWl0KCJjaGFuZ2VkIil9fWNvbnN0IFF0PWFzeW5jKCk9PntpZihkZSgpKXthd2FpdCBFLnVpLnNob3dUb2FzdCh7bWVzc2FnZToiQW5vdGhlciB1c2VyIGhhcyBhbHJlYWR5IGVuYWJsZWQgdGhlIHJlY29yZGluZyJ9KTtyZXR1cm59Y29uc3QgZT12LmluZmluaXR5LnNpcF9kb21haW4sdD1gJHtZLmNvbmZlcmVuY2VBbGlhc31AJHtlfWAsbj1hd2FpdCBXLnN0YXJ0UmVjb3JkaW5nKHQpO24uc3VjY2Vzcz8oTmUoe3N0YXR1czoiQ29ubmVjdGluZyIsLi4ubi5kYXRhfSksTS5lbWl0KCJjaGFuZ2VkIiksYXdhaXQgRS51aS5zaG93VG9hc3Qoe21lc3NhZ2U6IlJlY29yZGluZyByZXF1ZXN0ZWQuIEl0IHdpbGwgc3RhcnQgaW4gYSBmZXcgc2Vjb25kcy4ifSksS3QoKSk6YXdhaXQgRS51aS5zaG93VG9hc3Qoe21lc3NhZ2U6IkNhbm5vdCBzdGFydCB0aGUgcmVjb3JkaW5nIn0pfSxZdD1hc3luYygpPT57Y29uc3QgZT1MKCk7KGUhPW51bGw/YXdhaXQgVy5zdG9wUmVjb3JkaW5nKGUpOnZvaWQgMCk/LnN1Y2Nlc3M9PT0hMHx8IWRlKCk/KEZlKCksTS5lbWl0KCJjaGFuZ2VkIiksYXdhaXQgRS51aS5zaG93VG9hc3Qoe21lc3NhZ2U6IlJlY29yZGluZyBzdG9wcGVkIn0pKTphd2FpdCBFLnVpLnNob3dUb2FzdCh7bWVzc2FnZToiQ2Fubm90IHN0b3AgdGhlIHJlY29yZGluZyJ9KX0sWnQ9YXN5bmMoKT0+e2NvbnN0IGU9TCgpO2lmKGU9PW51bGwpcmV0dXJuO2NvbnN0IHQ9YXdhaXQgVy5nZXRTdGF0dXMoZSk7aWYodC5zdWNjZXNzKXtjb25zdHtkYXRhOntzdGF0dXM6bix2aWRlb0lkOmE9ZS52aWRlb0lkfX09dDtyZXR1cm4obiE9PWUuc3RhdHVzfHxhIT09ZS52aWRlb0lkKSYmKFgoe3N0YXR1czpuLHZpZGVvSWQ6YX0pLE0uZW1pdCgiY2hhbmdlZCIpKSxlLnN0YXR1c319O2FzeW5jIGZ1bmN0aW9uIEt0KGU9NjApe2NvbnN0IHQ9bmV3IFByb21pc2UoKG4sYSk9Pk0ub25jZSgiY2hhbmdlZCIsbikpO3RyeXthd2FpdCBjZSh0LGUpfWNhdGNoe2lmKCFRKCkpcmV0dXJuO2NvbnN0IGE9bGUoKTthIT1udWxsJiZhLnNlcnZpY2VUeXBlIT09ImNvbm5lY3RpbmciPyhYKHtzdGF0dXM6IlJlY29yZGluZyIscGFydGljaXBhbnRVdWlkOmEudXVpZH0pLE0uZW1pdCgiY2hhbmdlZCIpKTooWCh7c3RhdHVzOiJDb25uZWN0aW5nRmFpbGVkIn0pLE0uZW1pdCgiY2hhbmdlZCIpLGF3YWl0IEUudWkuc2hvd1RvYXN0KHttZXNzYWdlOiJDYW5ub3Qgc3RhcnQgdGhlIHJlY29yZGluZyJ9KSl9fWNvbnN0IGxlPSgpPT57Y29uc3R7cGFydGljaXBhbnRVdWlkOmV9PUwoKT8/e307cmV0dXJuIERlKGU9PW51bGw/Vy5pc1JlY29yZGluZ1BhcnRpY2lwYW50OnQ9PnQudXVpZD09PWUpfSxkZT0oKT0+RGUoVy5pc1JlY29yZGluZ1BhcnRpY2lwYW50KSE9bnVsbCxNPW5ldyBBZSxEPXtpbml0OnF0LHN0YXJ0UmVjb3JkaW5nOlF0LHN0b3BSZWNvcmRpbmc6WXQsZ2V0U3RhdHVzOlp0LGhhc1JlY29yZGluZzpMZSxpc1JlY29yZGluZzp1ZSxlbWl0dGVyOk19LGVuPWFzeW5jKCk9Pntjb25zdCBlPSJMb2cgb3V0Iix0PWF3YWl0IEUudWkuYWRkUHJvbXB0KHt0aXRsZToiTG9nIG91dCIsZGVzY3JpcHRpb246IkRvIHlvdSB3YW50IHRvIGxvZyBvdXQgZnJvbSBWYnJpY2s/Iixwcm9tcHQ6e3ByaW1hcnlBY3Rpb246ZSxzZWNvbmRhcnlBY3Rpb246IkNhbmNlbCJ9fSk7dC5vbklucHV0LmFkZChhc3luYyBuPT57YXdhaXQgdC5yZW1vdmUoKSxuPT09ZSYmYXdhaXQgUy5sb2dvdXQoKX0pfSxCZT17cG9zaXRpb246InRvb2xiYXIiLGljb246Ikljb25MaXZlU3RyZWFtIix0b29sdGlwOiJSZWNvcmRpbmdzIixyb2xlczpbImNoYWlyIl19O2xldCBvZTtjb25zdCBWZT0icGV4aXAtdmJyaWNrLWF1dGgiLEplPSJwZXhpcC12YnJpY2stdmlkZW9zIixJZT0idG9vbGJhcj0wLHNjcm9sbGJhcnM9MSxzdGF0dXM9MSxyZXNpemFibGU9MSxsb2NhdGlvbj0xLG1lbnVCYXI9MCx3aWR0aD01MDAsaGVpZ2h0PTUwMCxsZWZ0PTYwMCx0b3A9MjUwIix0bj1hc3luYygpPT57b2U9YXdhaXQgRS51aS5hZGRCdXR0b24oQmUpLG9lLm9uQ2xpY2suYWRkKHJuKX0sSD1hc3luYygpPT57YXdhaXQgb2UudXBkYXRlKHsuLi5CZSxpc0FjdGl2ZTpELmlzUmVjb3JkaW5nKCksZ3JvdXA6YXdhaXQgbm4oKX0pfSxubj1hc3luYygpPT57Y29uc3QgZT1hd2FpdCBTLmdldEF1dGhVcmwoKTtpZighUy5pc0F1dGhlbnRpY2F0ZWQoKSlyZXR1cm5be2lkOiJsb2dpbi1idXR0b24iLGljb246Ikljb25MZWF2ZSIsdG9vbHRpcDoiTG9nIGluIixyb2xlczpbImNoYWlyIl0sb3BlbnNQb3B1cDp7aWQ6VmUsb3BlblBhcmFtczpbZSwiIixJZV19fV07Y29uc3QgdD1bXTtyZXR1cm4gdC5wdXNoKEQuaXNSZWNvcmRpbmcoKT97aWQ6InN0b3AtYnV0dG9uIixpY29uOiJJY29uU3RvcFJvdW5kIix0b29sdGlwOiJTdG9wIHJlY29yZGluZyIscm9sZXM6WyJjaGFpciJdLGlzQWN0aXZlOiEwfTp7aWQ6InN0YXJ0LWJ1dHRvbiIsaWNvbjoiSWNvblBsYXlSb3VuZCIsdG9vbHRpcDoiU3RhcnQgcmVjb3JkaW5nIixyb2xlczpbImNoYWlyIl19LHtpZDoidmlkZW9zLWJ1dHRvbiIsaWNvbjoiSWNvbk9wZW5Jbk5ldyIsdG9vbHRpcDoiTWFuYWdlIHJlY29yZGluZ3MiLHJvbGVzOlsiY2hhaXIiXSxvcGVuc1BvcHVwOntpZDpKZSxvcGVuUGFyYW1zOlt2LnZicmljay51cmwrIi8jL21lZGlhL3VwbG9hZHM/c29ydEZpZWxkPXdoZW5VcGxvYWRlZCIsIiIsSWVdfX0se2lkOiJsb2dvdXQtYnV0dG9uIixpY29uOiJJY29uTGVhdmUiLHRvb2x0aXA6IkxvZyBvdXQiLHJvbGVzOlsiY2hhaXIiXX0pLHR9LHJuPSh7YnV0dG9uSWQ6ZX0pPT57c3dpdGNoKGUpe2Nhc2UibG9naW4tYnV0dG9uIjp7U2UoVmUpO2JyZWFrfWNhc2UibG9nb3V0LWJ1dHRvbiI6e2VuKCkuY2F0Y2goY29uc29sZS5lcnJvcik7YnJlYWt9Y2FzZSJzdGFydC1idXR0b24iOntELnN0YXJ0UmVjb3JkaW5nKCkuY2F0Y2goY29uc29sZS5lcnJvcik7YnJlYWt9Y2FzZSJzdG9wLWJ1dHRvbiI6e0Quc3RvcFJlY29yZGluZygpLmNhdGNoKGNvbnNvbGUuZXJyb3IpO2JyZWFrfWNhc2UidmlkZW9zLWJ1dHRvbiI6e1NlKEplKTticmVha319fSxTZT1lPT57c2V0VGltZW91dCgoKT0+e3dpbmRvdy5wbHVnaW4ucG9wdXBNYW5hZ2VyLmdldChlKT8uZm9jdXMoKX0sMCl9LGVlPWF3YWl0IGR0KHtpZDoicGx1Z2luLXJlY29yZGluZy12YnJpY2siLHZlcnNpb246MH0pO2h0KGVlKTtELmluaXQoKTthd2FpdCB0bigpO2VlLmV2ZW50cy5hdXRoZW50aWNhdGVkV2l0aENvbmZlcmVuY2UuYWRkKGU9PnttdChlLmNvbmZlcmVuY2VBbGlhcyxlLmNvbmZlcmVuY2VOYW1lKX0pO1MuZW1pdHRlci5vbigibG9naW4iLCgpPT57SCgpLmNhdGNoKGNvbnNvbGUuZXJyb3IpLGVlLnVpLnNob3dUb2FzdCh7bWVzc2FnZToiTG9nZ2VkIGludG8gVmJyaWNrIn0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpfSk7Uy5lbWl0dGVyLm9uKCJyZWZyZXNoZWRfdG9rZW4iLCgpPT57SCgpLmNhdGNoKGNvbnNvbGUuZXJyb3IpfSk7Uy5lbWl0dGVyLm9uKCJsb2dvdXQiLCgpPT57SCgpLmNhdGNoKGNvbnNvbGUuZXJyb3IpLGVlLnVpLnNob3dUb2FzdCh7bWVzc2FnZToiTG9nZ2VkIG91dCBmcm9tIFZicmljayJ9KS5jYXRjaChjb25zb2xlLmVycm9yKX0pO0QuZW1pdHRlci5vbigiY2hhbmdlZCIsKCk9PntIKCkuY2F0Y2goY29uc29sZS5lcnJvcil9KTthd2FpdCBTLmlzU2Vzc2lvblZhbGlkKCk/YXdhaXQgUy5yZWZyZXNoQWNjZXNzVG9rZW4oKTooUy5jbGVhblNlc3Npb24oKSxhd2FpdCBIKCkpOzwvc2NyaXB0PgoKPGJvZHk+DQ0KPC9ib2R5Pg0KDQo8L2h0bWw+"},folder:"plugins/vbrick"};function Ml(l){const Z=atob(l).split("").map(c=>c.charCodeAt(0));return new Uint8Array(Z)}function Cl(...l){return l.filter(Z=>Z!=null&&Z!=="").reduce((Z,c)=>`${Z!==""?Z.replace(/\/*$/,"/"):""}${c.replaceAll(/[/\\]+/g,"/")}`,"")}function yZ(l){return{...l,assets:Object.fromEntries(Object.entries(l.assets).map(([Z,c])=>[Z,typeof c=="string"?Ml(c):c]))}}function vZ(l){return Cl(l.folder,l.main)}function sZ(l,Z,c=""){const{assets:n,folder:d}=Z;for(const[b,W]of Object.entries(n)){const u=typeof W=="string"?Ml(W):W,X=Cl(c,d,b);l[X]=u}return l}const Zl=yZ(oZ),El="webapp3/branding",NZ="-vbrick";async function Dl(l){if(l==null)return{};const Z=new Uint8Array(await l.arrayBuffer());return tZ(Z)}async function IZ(l){if(l==null)return;const Z=await Dl(l),c=Cl(El,Zl.folder,"config.json"),n=Object.entries(Z).find(([d,b])=>d.endsWith(c));return n!=null?JSON.parse(Kl(n[1])):void 0}function JZ(l){return`${(l?.name??"branding").replace(/\.zip$/i,NZ)}.zip`}function RZ(l,Z){const{manifest:c,manifestPath:n}=FZ(l);SZ(c,Z),c.applicationConfig={...c.applicationConfig,handleOauthRedirects:!0},Z.updateVersion===!0&&(c.version=(c.version??0)+1),l[n]=pl(JSON.stringify(c))}function FZ(l){const[Z,c]=Object.entries(l).find(([d])=>d.endsWith("manifest.json"))??["",new Uint8Array];if(Z===""||c.length===0)throw new Error("Invalid branding zip - no manifest.json found");const n=JSON.parse(Kl(c));return{manifestPath:Z,manifest:n}}function SZ(l,Z){const{sandboxValues:c=["allow-same-origin","allow-popups","allow-forms"]}=Z,n={src:vZ(Zl),sandboxValues:c};l.plugins??=[];const d=l.plugins.find(({src:b})=>b.endsWith(n.src));d!=null?d.sandboxValues=n.sandboxValues:l.plugins.push(n)}async function LZ(l,Z){const c={},n=await Dl(l);RZ(n,c);const d={...Zl,assets:{...Zl.assets,"config.json":pl(JSON.stringify(Z,null,"  "))}};sZ(n,d,El),console.log("Plugin artifacts:",Object.keys(n));const b=rZ(n);return new File([b],JZ(l),{type:"application/x-zip-compressed"})}const _=l=>document.querySelector(l);function Gl(l,Z,c){_(l).addEventListener(Z,c)}Gl("#recording_type","change",l=>{const c=l.target.value==="rtmp";_("#config_form").classList.toggle("is-rtmp",c)});Gl("#pexip_url","input",l=>{const{value:Z}=l.target;URL.canParse(Z)&&(_("#sip_domain").placeholder=new URL(Z).hostname),Al()});Gl("#branding_path","input",l=>{Al()});function Al(){const{value:l}=_("#pexip_url"),{value:Z="webapp3"}=_("#branding_path");if(URL.canParse(l)){const c=new URL(Z,l);c.pathname=c.pathname.replace(/\/*$/,"/oauth-redirect"),_("#redirect_uri").value=c.toString()}}Gl("#branding","change",l=>{const Z=_("#branding").files?.[0];Z!=null&&IZ(Z).then(c=>{c!=null&&(console.log("Updating config from branding",c),_l(c))}).catch(c=>{console.warn("error on getting config",c)})});Gl("#config_form","submit",l=>{l.preventDefault();const{config:Z,brandingZipFile:c}=KZ();LZ(c,Z).then(n=>{const d=URL.createObjectURL(n),b=_("#download_link");b.setAttribute("href",d),b.innerText=`Download ${n.name}`,b.download=n.name}).catch(n=>{console.warn("error on generating config",n)})});function Tl(l){return l==null||l===""}function KZ(){const l=document.querySelectorAll("#config_form :is(input,select)"),Z=Array.from(l).map(d=>[d.name,d.type==="file"&&d.files!=null?d.files[0]:d.value]),c=Object.fromEntries(Z);c.sip_domain||=new URL(c.pexip_url).hostname;const n={recording_type:c.recording_type,vbrick:{url:c.vbrick_url,client_id:c.client_id,redirect_uri:c.redirect_uri},infinity:{sip_domain:c.sip_domain},recorder:{url:c.recorder_url,route:c.recorder_route,display_name:c.display_name,legacy_dialout_api:/yes|true|checked/i.test(c.legacy_dialout_api)}};return console.log("Plugin Config: ",n),{config:n,brandingZipFile:c.branding}}function _l(l={}){CZ(l);const Z=[["pexip_url","input",l.infinity_url],["recording_type","change",l.recording_type],["branding_path","input",l.branding_path],["vbrick_url","change",l.vbrick?.url],["client_id","change",l.vbrick?.client_id],["redirect_uri","change",l.vbrick?.redirect_uri],["recorder_url","change",l.recorder?.url],["recorder_route","change",l.recorder?.route],["sip_domain","change",l.infinity?.sip_domain]];gZ(Z)}Zl.defaults!=null&&typeof Zl.defaults=="object"&&_l(Zl.defaults);function CZ(l={}){const{redirect_uri:Z=""}=l.vbrick??{};if(URL.canParse(Z)){const c=new URL(Z);return l.infinity_url||=c.origin,l.branding_path||=c.pathname.replace("/oauth-redirect","").slice(1),l}}function gZ(l){for(const[Z,c,n]of l){if(Tl(n))continue;const d=_(`#${Z}`);(Tl(d.value)||d instanceof HTMLSelectElement)&&(d.value=n);const b=new CustomEvent(c);d.dispatchEvent(b)}}</script>
    </head>

    <body>
        <form id="config_form">
            <fieldset>
                <legend>Branding</legend>
                <label for="branding">
                    <strong>Branding ZIP File</strong>
                    <input type="file" id="branding" name="branding" accept=".zip" />
                </label>
            </fieldset>
            <fieldset>
                <legend>Infinity</legend>
                <label for="pexip_url">
                    <strong>Infinity URL</strong>
                    <input
                        type="url"
                        id="pexip_url"
                        name="pexip_url"
                        required
                    />
                </label>
                <label for="branding_path">
                    <strong>Branding Path</strong>
                    <input
                        type="text"
                        id="branding_path"
                        name="branding_path"
                        required
                    />
                </label>
                <!-- <label for="update_version">
                    <strong>Update manifest version</strong>
                    <input
                        type="checkbox"
                        id="update_version"
                        name="update_version"
                    />
                </label> -->
            </fieldset>
            <fieldset>
                <legend>Vbrick</legend>
                <label for="vbrick_url">
                    <strong>Vbrick Rev URL</strong>
                    <input
                        type="url"
                        id="vbrick_url"
                        name="vbrick_url"
                        required
                    />
                </label>
                <label for="client_id">
                    <strong>OAuth Client ID</strong>
                    <input
                        type="text"
                        id="client_id"
                        name="client_id"
                        required
                    />
                </label>
                <label for="redirect_uri">
                    <strong>OAuth redirect uri</strong>
                    <input
                        type="text"
                        id="redirect_uri"
                        name="redirect_uri"
                        placeholder="calculated from Infinity URL"
                        readonly
                    />
                </label>
            </fieldset>
            <fieldset>
                <label for="recording_type">
                    <strong>Recording Type</strong>
                    <select id="recording_type" name="recording_type">
                        <option value="sip" selected>SIP</option>
                        <option value="rtmp">RTMP</option>
                    </select>
                </label>
            </fieldset>
            <fieldset id="sip_settings">
                <label for="sip_domain">
                    <strong>Pexip sip domain</strong>
                    <input
                        type="text"
                        id="sip_domain"
                        name="sip_domain"
                        placeholder="leave blank if same as Infinity URL"
                    />
                </label>
            </fieldset>
            <fieldset id="rtmp_settings">
                <legend>RTMP Recording</legend>
                <label for="recorder_url">
                    <strong>On-prem Recorder URL</strong>
                    <input
                        type="url"
                        id="recorder_url"
                        name="recorder_url"
                        placeholder="https://rtmp.recorder.url"
                    />
                </label>
                <label for="recorder_route">
                    <strong>Route</strong>
                    <input
                        type="text"
                        id="recorder_route"
                        name="recorder_route"
                        value="vmr"
                    />
                </label>
                <label for="display_name">
                    <strong>Display Name</strong>
                    <input
                        type="text"
                        id="display_name"
                        name="display_name"
                        value="Vbrick Recorder"
                    />
                </label>
                <label for="legacy_dialout_api">
                    <strong>Use Legacy DialOut API?</strong>
                    <select
                        id="legacy_dialout_api"
                        name="legacy_dialout_api"
                    >
                        <option value="" selected>No</option>
                        <option value="true">Yes</option>
                    </select>
                </label>
            </fieldset>
            <fieldset class="grid">
                <button type="reset">Reset Form</button>
                <button type="submit">Create Plugin ZIP</button>
                <a id="download_link" target="_blank" download="plugin.zip">Download plugin.zip</a>
            </fieldset>
        </form>
        
    </body>
</html>
